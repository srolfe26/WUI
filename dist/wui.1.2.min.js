/*! Wui 1.2
 * Copyright (c) 2013-2016 Stephen Rolfe Nielsen (rolfe.nielsen@gmail.com)
 *
 * @license MIT
 * http://www.wui-js.com/wui-1-2/license.html
 */ 

!function(e,t,i){"undefined"!=typeof module&&module.exports?module.exports=i():e[t]=i()}(this,"verge",function(){function e(){return{width:d(),height:c()}}function t(e,t){var i={};return t=+t||0,i.width=(i.right=e.right+t)-(i.left=e.left-t),i.height=(i.bottom=e.bottom+t)-(i.top=e.top-t),i}function i(e,i){return e=e&&!e.nodeType?e[0]:e,e&&1===e.nodeType?t(e.getBoundingClientRect(),i):!1}function n(t){t=null==t?e():1===t.nodeType?i(t):t;var n=t.height,a=t.width;return n="function"==typeof n?n.call(t):n,a="function"==typeof a?a.call(t):a,a/n}var a={},r="undefined"!=typeof window&&window,l="undefined"!=typeof document&&document,o=l&&l.documentElement,s=r.matchMedia||r.msMatchMedia,u=s?function(e){return!!s.call(r,e).matches}:function(){return!1},d=a.viewportW=function(){var e=o.clientWidth,t=r.innerWidth;return t>e?t:e},c=a.viewportH=function(){var e=o.clientHeight,t=r.innerHeight;return t>e?t:e};return a.mq=u,a.matchMedia=s?function(){return s.apply(r,arguments)}:function(){return{}},a.viewport=e,a.scrollX=function(){return r.pageXOffset||o.scrollLeft},a.scrollY=function(){return r.pageYOffset||o.scrollTop},a.rectangle=i,a.aspect=n,a.inX=function(e,t){var n=i(e,t);return!!n&&n.right>=0&&n.left<=d()},a.inY=function(e,t){var n=i(e,t);return!!n&&n.bottom>=0&&n.top<=c()},a.inViewport=function(e,t){var n=i(e,t);return!!n&&n.bottom>=0&&n.right>=0&&n.top<=c()&&n.left<=d()},a}),jQuery.extend(verge),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var i,n;if(null==this)throw new TypeError(" this is null or not defined");var a=Object(this),r=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(i=t),n=0;r>n;){var l;n in a&&(l=a[n],e.call(i,l,n,a)),n++}}),function(){"use strict";var e=Array.prototype.slice;try{e.call(document.documentElement)}catch(t){Array.prototype.slice=function(t,i){if(i="undefined"!=typeof i?i:this.length,"[object Array]"===Object.prototype.toString.call(this))return e.call(this,t,i);var n,a,r=[],l=this.length,o=t||0;o=o>=0?o:Math.max(0,l+o);var s="number"==typeof i?Math.min(i,l):l;if(0>i&&(s=l+i),a=s-o,a>0)if(r=new Array(a),this.charAt)for(n=0;a>n;n++)r[n]=this.charAt(o+n);else for(n=0;a>n;n++)r[n]=this[o+n];return r}}}(),function(){for(var e,t=function(){},i=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=i.length,a=window.console=window.console||{};n--;)e=i[n],a[e]||(a[e]=t)}();var Wui=Wui||{version:"1.2.0"};!function(e,t){e.ajaxSetup({cache:!1}),Wui.forAjaxFileUpload=function(e,t){var i=0,n=0,a=new FormData;for(i in e)if(e[i]instanceof FileList)if(e[i].length>1||t)for(n=0;n<e[i].length;n++)a.append(i+"_"+n,e[i][n]);else a.append(i,e[i][0]);else null===e[i]?a.append(i,""):a.append(i,e[i]);return a},Wui.id=function(){return void 0===Wui.idCounter&&(Wui.idCounter=0),"wui-"+Wui.idCounter++},Wui.getKeys=function(t){var i=[];return t&&e.each(t,function(e){i.push(e)}),i.sort()},Wui.scrollbarWidth=function(){var t,i,n;return void 0===n&&(t=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),i=t.children(),n=i.innerWidth()-i.height(99).innerWidth(),t.remove()),n},Wui.isPercent=function(){return arguments[0]&&arguments[0].indexOf&&-1!=arguments[0].indexOf("%")},Wui.percentToPixels=function(i,n,a){var r=i.parent(),l=r[0]===e(t)[0]||r[0]===e("html")[0]||r[0]===e("body")[0],o=l?"height"==a?e.viewportH():e.viewportW():r[a]();return Math.floor(parseFloat(n)/100*o)},Wui.randNum=function(e,t){return t=t-e+1,e+Math.floor(Math.random()*t)},Wui.maxZ=function(){var t=e("body *"),i=t.length<2500?t:e('body > *, [style*="z-index"]'),n=Math.max.apply(null,e.map(i,function(t){return"static"!=e(t).css("position")?parseInt(e(t).css("z-index"))||0:void 0}));return(e.isNumeric(n)?n:0)+1},Wui.unwrapData=function(e){var t=this,i=t.hasOwnProperty("dataContainer")?t.dataContainer:Wui.Data.prototype.dataContainer,n=t.hasOwnProperty("totalContainer")?t.totalContainer:Wui.Data.prototype.totalContainer,a=i&&e[i]?e[i]:e,r=n&&e[n]?e[n]:a.length;return{data:a,total:r}},Wui.positionItem=function(i,n){var a=i[0].getBoundingClientRect(),r=a.top,l=function(){var t="absolute";return i.add(i.parents()).each(function(){"fixed"===e(this).css("position")&&(t="fixed")}),t}(),o=n.outerWidth(),s=n.outerHeight(),u=function(){var t=r+i.outerHeight()+s<e.viewportH();return!t&&0>r-s?(s=r-5,t=r+i.outerHeight()+s<e.viewportH()):s="",t}(),d=a.left+i.outerWidth()-o>0;"fixed"===l&&(r+=e(t).scrollTop()),n.css({left:d?a.left+i.outerWidth()-o:a.left,top:u?r+i.outerHeight():r-(e.isNumeric(s)?s:n.outerHeight()),height:s,position:l,zIndex:Wui.maxZ()})},Wui.cssCheck=function(e){for(var t=0,i=e.split("-"),n="";t<i.length;t++)n+=i[t].charAt(0).toUpperCase()+i[t].slice(1);for(var a=0,r=document.createElement("detect"),l=n.charAt(0).toLowerCase()+n.slice(1),o="Webkit Moz O ms".split(" "),s="-webkit- -moz- -o- -ms-".split(" "),u=(e+" "+l+" "+o.join(n+" ")+n).split(" "),d=!1;a<u.length;a++)if(""===r.style[u[a]]){d=u[a];break}if(!d)return!1;switch(a){case 0:case 1:return e;default:return s[a-2]+e}},Wui.fit=function(t,i){if(t instanceof Array&&t.length>0){var n=0,a=t[0].parent?t[0].parent:t[0].el.parent(),r=a.el?a.elAlias||a.el:a,l="width"==i?"row":"column";if(i="row"==l?"width":"height",r.css("display",Wui.cssCheck("flex")).css(Wui.cssCheck("flex-direction"),l),e.each(t,function(t,a){e.isNumeric(a.fit)&&a.fit>=0?(n+=a.fit,a[i]=-1):a[i]?delete a.fit:n+=a.fit=1}),0===n){var o=t[t.length-1];n+=o.fit=1,o[i]=-1}e.each(t,function(t,n){n.fit?e(n.el).css(Wui.cssCheck("flex"),n.fit+" auto"):void 0===n.cssByParam&&(e(n.el).css(i,n[i]),e(n.el).css(Wui.cssCheck("flex"),""))})}else console.log("Improper collection specified",arguments)}}(jQuery,this),function(e,t){t.O=function(t){e.extend(this,{hidden:!1},t)},t.O.prototype={addToDOM:function(t,i,n){var a=void 0!==t.appendTo?t.appendTo:void 0!==t.prependTo?t.prependTo:void 0!==i&&null!==i?i:void 0!==t.parent&&void 0!==t.parent.elAlias?t.parent.elAlias:void 0!==t.parent&&void 0!==t.parent.el?t.parent.el:e("body"),r=void 0!==t.appendTo?"append":void 0!==t.prependTo?"prepend":void 0!==n&&a[n]?n:"append";try{e(a)[r](t.el)}catch(l){try{e(a)[r](t)}catch(o){}}return this.cssByParam(t),this.afterRender&&this.afterRender(),!0},afterRender:function(){this.each(function(e){e.afterRender&&e.afterRender()})},append:function(){var t=this,i=t.elAlias||t.el;e.each(arguments,function(e,t){i.append(t)})},clear:function(){var e=this,t=e.elAlias||e.el;t.children().remove()},callRender:function(){var e=this;e.onRender&&e.onRender(),e.each(function(e){e.callRender&&e.callRender()}),e.afterRender&&e.afterRender(),e.layoutKids()},applyAttr:function(t,i){var n="string"==typeof i||"number"==typeof i;return n&&e(this.el).attr(t,i),n},argsByParam:function(){var e=this;e.applyAttr("id",e.id),e.applyAttr("name",e.name),e.applyAttr("tabindex",e.tabIndex),e.applyAttr("lang",e.lang),e.applyAttr("title",e.titleAttr)},cssByParam:function(i){var n;if(i=i||this,i.el&&i.el.addClass){i.argsByParam&&i.argsByParam();try{i.attr&&"object"==typeof i.attr&&i.el.attr(i.attr)}catch(a){}return e.isNumeric(i.height)&&i.height>=0&&i.el.css({height:i.height}),e.isNumeric(i.width)&&i.width>=0&&i.el.css({width:i.width}),t.isPercent(i.width)&&(n=t.percentToPixels(i.el,i.width,"width"),0!==n&&i.el.css({width:n})),t.isPercent(i.height)&&(n=t.percentToPixels(i.el,i.height,"height"),0!==n&&i.el.css({height:n})),i.hidden&&i.el.css("display","none"),i.el.addClass(i.cls)}return i},each:function(e,t){t="undefined"==typeof t?!0:t;var i=t?0:this.items.length-1;if(this.items)if(t)for(i;i<this.items.length&&e(this.items[i],i)!==!1;i++);else for(i;i>=0&&e(this.items[i],i)!==!1;i--);return!0},hide:function(){var t=["fadeOut"];return e.each(arguments,function(e,i){t.push(i)}),this.hidden=!0,this.showHide.apply(this,t)},index:function(){var e,t=this;return t.parent&&t.parent.each(function(i,n){i===t&&(e=n)}),e},layout:function(e){this.cssByParam(this),this.layoutKids(),e&&"function"==typeof e&&e()},layoutKids:function(){var e=this,i=!1;e.each(function(e){return e.fit?(i=!0,!1):void 0}),(e.fitDimension||i)&&t.fit(e.items,e.fitDimension||void 0),e.each(function(e){e.layout&&e.layout()})},move:function(t){var i=this,n=i.index();t=e.isNumeric(t)?t:0,void 0!==n&&(i=Array.prototype.splice.call(i.parent.items,n,1)[0],Array.prototype.splice.call(i.parent.items,t,0,i),0===t?i.parent.items[1].el.before(i.el):t>i.parent.items.length?i.parent.items[i.parent.items.length-2].el.after(i.el):i.parent.items[t-1].el.after(i.el))},place:function(e){var t=this;return void 0===t.items&&(t.items=[]),t.each(function(e){e.parent=t,e.place?e.place():t.addToDOM(e)}),t.addToDOM(t),e&&"function"==typeof e&&e(t),void 0===t.parent&&t.callRender(),t},push:function(){var t=this;return void 0===t.items&&(t.items=[]),e.each(arguments,function(e,i){i.parent=t,i.place?i.place():t.addToDOM(i),i.onRender&&i.onRender(),i.layout&&i.layout()}),Array.prototype.push.apply(t.items,arguments)},remove:function(){var e=this,t=null;e.parent&&(e.parent.each(function(i,n){i===e&&(t=n)},!1),null!==t&&e.parent.splice(t,1)),this.el.remove()},show:function(){var t=["fadeIn"];return e.each(arguments,function(e,i){t.push(i)}),this.hidden=!1,this.showHide.apply(this,t)},showHide:function(e,t,i){return t="number"==typeof t?t:1,"function"==typeof arguments[1]&&(i=arguments[0]),this.el[e](t,i)},splice:function(e,t){function i(e){e.parent=n,e.onRender&&e.onRender(),e.layout&&e.layout()}var n=this,a=n.elAlias||n.el;e=parseInt(e),void 0===n.items&&(n.items=[]);for(var r=e;e+t>r;r++)n.items[r]&&n.items[r].el&&n.items[r].el.remove();var l=Array.prototype.splice.apply(n.items,arguments),o=arguments.length-2;if(n.items.length==o)for(r=0;r<n.items.length;r++)n.addToDOM(n.items[r],a),i(n.items[r]);else if(void 0===n.items[e+o])for(r=e;r<n.items.length;r++)n.addToDOM(n.items[r],n.items[r-1].el,"after"),i(n.items[r]);else if(0!==o)for(r=e+o;r>0;r--)n.addToDOM(n.items[r-1],n.items[r].el,"before"),i(n.items[r-1]);return l}},t.LongPoll=function(t){e.extend(this,{pollTime:1e3,maxRetry:120,waitFactor:2,url:null,params:null,name:null,ajaxParams:{}},t),this.init()},t.LongPoll.prototype={init:function(){var e=this;e.originalPollTime=e.pollTime,e.naturalPollTime=e.pollTime+1,e.name=e.name?e.name:t.id(),e.start()},poll:function(){var t=this,i=t.name?"."+t.name:"";setTimeout(function(){e.ajax(e.extend(t.ajaxParams,{url:t.url,data:t.params,beforeSend:function(n){return t.pollTime>t.originalPollTime*t.maxRetry?(n.abort(),e(window).trigger(e.Event("pollStopped"+i),[t]).trigger(e.Event("pollStopped"),[t]),!1):void 0},success:function(n){t.pollTime=t.naturalPollTime,e(window).trigger(e.Event("pollSuccess"+i),[t,n]).trigger(e.Event("pollSuccess"),[t,n])},complete:function(){t.poll()},timeout:t.pollTime,error:function(n){t.pollTime=t.pollTime==t.naturalPollTime?t.originalPollTime:t.pollTime*t.waitFactor,e(window).trigger(e.Event("pollError"+i),[t,n]).trigger(e.Event("pollError"),[t,n])}}))},t.pollTime)},stop:function(){this.pollTime=this.pollTime*this.maxRetry+1},start:function(){var t=this,i=t.name?"."+t.name:"";t.pollTime=t.naturalPollTime,e(window).trigger(e.Event("pollStart"+i),[t]).trigger(e.Event("pollStart"),[t]),t.poll()}},t.Data=function(t){e.extend(this,{data:[],identity:null,name:null,params:{},url:null,ajaxConfig:{},total:0},t)},t.Data.prototype={dataContainer:null,totalContainer:null,dataChanged:function(){},dataEach:function(e){for(var t=0;t<this.data.length&&e(this.data[t],t)!==!1;t++);return!0},loadData:function(){var t=this,i=e.extend({data:t.params,dataType:"json",success:function(){t.success.apply(t,arguments)},error:function(){t.failure.apply(t,arguments)}},t.ajaxConfig),n=t.setParams.apply(t,arguments),a=t.beforeLoad.apply(t,arguments);return n!==!1&&a!==!1?(t.lastRequest&&4!=t.lastRequest.readyState&&t.lastRequest.abort(),t.lastRequest=e.ajax(t.url,i),t.lastRequest):e.Deferred().reject()},setParams:function(t){t&&"object"==typeof t&&e.extend(this.params,t)},setData:function(t,i){var n=this;n.beforeSet(t),n.data=n.processData(t),n.total=e.isNumeric(i)?i:n.data?n.data.length:0,n.fireDataChanged()},fireDataChanged:function(){var t=this,i=t.name||"wui-data";t.dataChanged(t.data),e(document).trigger(e.Event("datachanged."+i),[i,t]).trigger(e.Event("datachanged"),[i,t]),t.afterSet(t.data)},beforeLoad:function(){},afterSet:function(){},beforeSet:function(){},success:function(e){var i=this,n=t.unwrapData.call(i,e);i.onSuccess(e),i.setData(n.data,n.total)},onSuccess:function(){},onFailure:function(){},failure:function(e){this.onFailure(e)},processData:function(e){return e},push:function(){var e=Array.prototype.push.apply(this.data,arguments);return this.total=this.data.length,this.fireDataChanged(),e},splice:function(){var e=Array.prototype.splice.apply(this.data,arguments);return this.total=this.data.length,this.fireDataChanged(),e}},t.Template=function(t){e.extend(this,t)},t.Template.prototype={template:null,data:null,make:function(i){var n=this;if(n.data&&n.template){var a=n.template;return e.isNumeric(i)&&e.extend(n.data,{wuiIndex:i}),e(a.replace(/\{(\w*)\}/g,function(e,t){return void 0!==n.data[t]?n.data[t]:""}).replace(/\{\((.*?)\)\}/g,function(e,i){var a=t.getKeys(n.data),r=[],l=0;for(l=a.length-1;l>=0;l--)a[l].match(/\b\d+/g)&&a.splice(l,1);for(l=0;l<a.length;l++)r.push(n.data[a[l]]);a.push("return "+i);var o=Function.apply(null,a);return o.apply(null,r)}))}throw new Error("Wui.js - Template engine missing data and/or template.")}},t.DataList=function(t){e.extend(this,{afterMake:function(){},autoLoad:!0,displayMax:-1,el:e("<div>"),focusOnSelect:!0,init:function(){},multiSelect:!1,selected:[]},t),this.init()},t.DataList.prototype=e.extend(new t.O,new t.Template,new t.Data,{dataChanged:function(){this.make()},clearSelect:function(){var t=this,i=t.name?"."+t.name:"",n=t.elAlias||t.el;n.find(".wui-selected").removeClass("wui-selected"),t.selected=[],t.el.trigger(e.Event("wuichange"+i),[t,t.el,{},t.selected]).trigger(e.Event("wuichange"),[t,t.el,{},t.selected])},itemSelect:function(t,i){var n=this,a=n.name?"."+n.name:"",r=[];return n.selected.length>0&&!n.multiSelect&&!i&&(r=e.extend(!0,[],n.selected),n.el.trigger(e.Event("wuideselect"),[n,r[0].el,r[0].rec,r])),n.el.find(".wui-selected").removeClass("wui-selected").removeAttr("tabindex"),t.el.addClass("wui-selected").attr("tabindex",1),n.focusOnSelect&&t.el.focus(),n.selected=[t],i||n.el.trigger(e.Event("wuiselect"+a),[n,t.el,t.rec]).trigger(e.Event("wuichange"+a),[n,t.el,t.rec,n.selected]).trigger(e.Event("wuiselect"),[n,t.el,t.rec]).trigger(e.Event("wuichange"),[n,t.el,t.rec,n.selected]),t},itemDeselect:function(t){var i=this,n=i.name?"."+i.name:"";return i.selected.length>0&&t.el.removeClass("wui-selected"),i.selected=[],i.el.trigger(e.Event("wuideselect"+n),[i,t.el,t.rec]).trigger(e.Event("wuichange"+n),[i,t.el,t.rec,i.selected]).trigger(e.Event("wuideselect"),[i,t.el,t.rec]).trigger(e.Event("wuichange"),[i,t.el,t.rec,i.selected]),t},createItem:function(t){function i(i,n){var r,l;if(a.multiSelect&&(i.metaKey||i.ctrlKey||i.shiftKey))if(l=e(n).hasClass("wui-selected"),i.shiftKey){var s=a.selectByEl(a.el.find("tr.wui-selected:first")),u=a.getItemByEl(e(n)),d=s.rec.wuiIndex<u.rec.wuiIndex?1:-1,c=d>0?s:u,h=d>0?u:s,f=[];a.selected=f=a.items.slice(c.rec.wuiIndex,h.rec.wuiIndex+1),e("wui-selected").removeClass("wui-selected"),f.forEach(function(e){e.el.addClass("wui-selected")}),window.getSelection?r=window.getSelection():document.selection&&(r=document.selection),r&&(r.empty&&r.empty(),r.removeAllRanges&&r.removeAllRanges())}else e(n).toggleClass("wui-selected",!l),l?e.each(a.selected||[],function(e,i){i==t&&a.selected.splice(e,1)}):a.selected.push(t),a.el.trigger(e.Event("wuichange"+o),[a,t.el,t.rec,a.selected]).trigger(e.Event("wuichange"),[a,t.el,t.rec,a.selected]);else a.selected.length>0&&a.selected[0]===t?a.itemDeselect(t):a.itemSelect(t)}function n(){return a.itemSelect(t,!0),a.el.trigger(e.Event("wuichange"+o),[a,t.el,t.rec,a.selected]).trigger(e.Event("wuidblclick"+o),[a,t.el,t.rec]).trigger(e.Event("wuichange"),[a,t.el,t.rec,a.selected]).trigger(e.Event("wuidblclick"),[a,t.el,t.rec]),!1}var a=this,r=0,l=null,o=a.name?"."+a.name:"";return t.el.on("click",function(e){var t=null,a=this;return r++,1===r?l=setTimeout(function(){t=i(e,a),r=0},350):(clearTimeout(l),t=n(e,a),r=0),t}).on("dblclick",function(e){e.preventDefault()}),a.modifyItem(t)},modifyItem:function(e){return e.el},make:function(){var i=this,n=i.data||[],a=e("<div>"),r=i.name?"."+i.name:"";i.items=[];for(var l=0;i.displayMax<0&&l<n.length||i.displayMax>0&&l<i.displayMax&&l<n.length;l++){var o=i.data=n[l],s={el:t.Template.prototype.make.call(i,l),rec:o};Array.prototype.push.call(i.items,s),a.append(i.createItem(s))}i.clear(),i.append(a.children().unwrap()),i.data=n,i.autoLoad=!0,i.afterMake(),i.el.trigger(e.Event("refresh"+r),[i,i.data]).trigger(e.Event("refresh"),[i,i.data]),i.resetSelect()},onRender:function(){var t=this;t.onRendered!==!0&&(t.autoLoad&&(null===this.url?t.make():t.loadData()),e(document).on("keyup",function(e){t.selected&&t.selected[0]&&document.activeElement==t.selected[0].el[0]&&((13==e.keyCode||32==e.keyCode)&&(t.selected[0].el.click(),t.selected[0].el.click()),38==e.keyCode&&t.selectAjacent(-1),40==e.keyCode&&t.selectAjacent(1))}),t.onRendered=!0)},getItemByEl:function(e){var t,i=this;return i.each(function(i){i.el[0]==e[0]&&(t=i)}),t},refresh:function(){this.onRender()},copyArryRecs:function(t){var i=[];return t.forEach(function(t){var n={};e.each(t.rec,function(e,t){n[e]=t}),i.push(n)}),i},resetSelect:function(){var e=this,i=e.copyArryRecs(e.selected);i.length&&(e.selected=[],i.forEach(function(i){t.O.prototype.each.call(e,function(t){var n=e.identity?t.rec[e.identity]===i[e.identity]:JSON.stringify(t.rec)===JSON.stringify(i);n&&(e.multiSelect?(t.el.addClass("wui-selected"),e.selected.push(t,!0)):e.itemSelect(t))})}),e.scrollToCurrent())},scrollToCurrent:function(){var t=this,i=t.elAlias||t.el,n=i.find(".wui-selected:first"),a=n.offsetParent(),r=function(){var i=0;return n.prevAll().each(function(){i+=e(this).outerHeight()}),i-=(t.elAlias||t.el).height()/2-n.outerHeight()/2}();a.animate({scrollTop:r},100)},selectAjacent:function(e){var t=this,i=t.selected[0].el[e>0?"next":"prev"]();return t.selectByEl(i,!1)},selectBy:function(e,t){var i,n=this;return n.each(function(a){return void 0!==a.rec[e]&&a.rec[e]==t?i=n.itemSelect(a):void 0}),n.scrollToCurrent(),i},selectByEl:function(e,t){var i,n=this;return n.itemSelect(i=n.getItemByEl(e)),t!==!1&&n.scrollToCurrent(),i}}),t.Button=function(t){e.extend(this,{el:e("<button>").attr({unselectable:"on"}),disabled:!1,toolTip:null,tabIndex:0,text:"Button"},t),this.init()},t.Button.prototype=e.extend(new t.O,{click:function(){},init:function(){function t(){return i.disabled||(Array.prototype.push.call(arguments,i),i.click.apply(i,arguments),i.el.trigger(e.Event("wuibtnclick"+n),[i]).trigger(e.Event("wuibtnclick"),[i])),!1}var i=this,n=i.name?"."+i.name:"";i.el.addClass("wui-btn").click(t).keypress(function(e){return(13==e.keyCode||32==e.keyCode)&&t(e),!1}).html(i.text).attr({title:i.toolTip,tabindex:i.tabIndex}),i.disabled&&i.disable()},disable:function(){this.disabled=!0,this.el.toggleClass("disabled",this.disabled).attr("disabled",!0).removeAttr("tabindex")},enable:function(){this.disabled=!1,this.el.toggleClass("disabled",this.disabled).removeAttr("disabled").attr({tabindex:this.tabIndex})},setText:function(e){return this.el.html(e)}}),t.Pane=function(t){e.extend(this,{bbar:[],border:!0,tbar:[],disabled:!1,fitToContent:!1,titleAlign:"left",height:"100%",maskHTML:"Empty",maxHeight:null,title:null},t),this.init()},t.Pane.prototype=e.extend(new t.O,{addMask:function(t){return t=t?t:this.container.parent(),0===t.children("wui-mask").length?(this.mask=e("<div>").addClass("wui-mask").html(this.maskHTML).appendTo(t),this.mask):null},afterRender:function(){function e(){i.layoutInterval===!1&&(i.parent||i instanceof t.Window||i.layout(),i.layoutInterval=!0,setTimeout(function(){i.layoutInterval=!1},100))}var i=this;i.layoutInterval=!1,document.addEventListener?(document.addEventListener("animationstart",e,!1),document.addEventListener("MSAnimationStart",e,!1),document.addEventListener("webkitAnimationStart",e,!1)):document.attachEvent("MSAnimationStart",e),i.disabled&&i.disable(),i.configBar("header"),i.configBar("footer"),t.O.prototype.afterRender.call(this)},borderStyle:{borderWidth:6},configBar:function(e){var i=this,n=i[e],a="header"==e,r=a?"Top":"Bottom",l=function(){var e=a&&null!==i.title?1:0;return n.items.forEach(function(i){i instanceof t.O&&e++}),e>0}(),o=l?n.el.css("height"):0,s=l?0:void 0;i.parent&&i.parent instanceof t.Tabs&&(a&&i.tabsHideHeader&&!i.parent.tabsBottom||i.tabsBottom&&!l)&&(s=6),i.sureEl.css("border"+r+"Width",s).children(".wui-pane-wrap").css("padding"+r,o),l?(n.place(),n.callRender(),a?(i.setTitle(i.title),this.setTitleAlign()):!i.disabled&&n.items[n.items.length-1].el&&n.items[n.items.length-1].el.focus()):n.el.detach(),i.updateBorder()},disable:function(){return this.addMask(),this.footer.each(function(e){e.disable&&e.disable()}),this.header.each(function(e){e.disable&&e.disable()}),this.disabled=!0,this.disabled},enable:function(){var e=this;return e.removeMask(),e.footer.each(function(e){e.enable&&e.enable()}),e.header.each(function(e){e.enable&&e.enable()}),this.disabled=!1,this.disabled},init:function(i){var n=i||this;n.el=e("<div>").addClass("wui-pane").append(e("<div>").addClass("wui-pane-wrap").append(n.container=e("<div>").addClass("wui-pane-content"))),n.sureEl=n.el,n.border&&n.el.css(n.borderStyle),n.header=new t.O({el:e('<div><span></span><div class="wui-h-cntnt"></div></div>'),cls:"wui-pane-header wui-pane-bar",items:n.tbar,parent:n,appendTo:n.el,splice:function(){t.O.prototype.splice.apply(this,arguments),n.configBar("header")},push:function(){t.O.prototype.push.apply(this,arguments),n.configBar("header")}}),n.header.elAlias=n.header.el.children(".wui-h-cntnt"),n.header.title=n.header.el.children("span:first"),n.footer=new t.O({el:e("<div>"),cls:"wui-pane-footer wui-pane-bar",items:n.bbar,parent:n,appendTo:n.el,splice:function(){t.O.prototype.splice.apply(this,arguments),n.configBar("footer")},push:function(){t.O.prototype.push.apply(this,arguments),n.configBar("footer")}}),n.elAlias=n.container},layout:function(){if(t.O.prototype.layout.apply(this,arguments),this.fitToContent===!0){var i=this,n=i.header.el.outerHeight()+i.footer.el.outerHeight(),a=e.isNumeric(i.maxHeight)?i.maxHeight:0,r=0;i.container.children().each(function(){r+=e(this).outerHeight()}),r=a>0&&r+n>a?a:r,i.height=r+n,t.O.prototype.layout.apply(i,arguments)}},removeMask:function(){var e=this,t=e.mask||e.el.find(".wui-mask");t&&t.fadeOut(250,function(){e.mask=void 0,e.el.find(".wui-mask").remove()})},setMaskHTML:function(e){this.maskHTML=e,this.mask&&this.mask.html(e)},setTitle:function(e){return this.title=e,e=e&&"string"==typeof e?e:"",this.header.title.html(e),this.title},setTitleAlign:function(e){var t=this;t.titleAlign=e||t.titleAlign,t.header.title.removeClass("right,left,center").addClass("wui-h-title "+t.titleAlign);var i="right"===t.titleAlign?"left":"right";t.header.elAlias.css("text-align",i)},updateBorder:function(e){var t=this;e?t.el.css(t.borderStyle=e):t.border&&t.hasOwnProperty("borderStyle")&&t.el.css(t.borderStyle)}}),t.Window=function(t){e.extend(this,{bbar:[],border:!1,isModal:!1,onWinClose:function(){},onWinOpen:function(){},tbar:[],title:"Window",maskHTML:'Loading <span class="wui-spinner"></span>',resizable:!0,draggable:!0,windowLeft:null,windowTop:null},t),this.init()},t.Window.prototype=e.extend(new t.Pane,{close:function(){var t=this,i=t.name?"."+t.name:"";t.onWinClose(t)!==!1&&(t.windowEl.trigger(e.Event("close"+i),[t]).trigger(e.Event("close"),[t]),t.remove())},disable:function(){t.Pane.prototype.disable.call(this),this.closeBtn&&this.closeBtn.enable()},init:function(){function i(e){e.stopPropagation()}function n(){var e=t.maxZ();parseInt(a.el.css("z-index")||1)<=e&&a.el.css("z-index",e)}var a=this,r=a.name?"."+a.name:"";a.appendTo=e("body"),a.isModal&&(a.modalEl=e("<div>").addClass("wui-overlay"),e("body").append(a.appendTo=a.modalEl.css("z-index",t.maxZ()).on("mousewheel",i))),a.tbar.push(a.closeBtn=new t.Button({click:function(){a.close()},text:"X"})),0===a.bbar.length&&(a.bbar=[new t.Button({click:function(){a.close()},text:"Close"})]),t.Pane.prototype.init(a),a.windowEl=a.el.addClass("wui-window").css("z-index",t.maxZ()).click(n).on("mousewheel",i),a.draggable===!0&&a.windowEl.draggable({handle:a.header.el,start:n}),a.resizable===!0&&a.windowEl.resizable({minWidth:a.minWidth||a.width,minHeight:a.minHeight||a.height,resize:function(){a.fireResize()}}),a.place(),a.isModal&&(a.el=a.modalEl),a.onWinOpen(a),a.windowEl.trigger(e.Event("open"+r),[a]).trigger(e.Event("open"),[a]),a.resize()},fireResize:function(){var t=this,i=t.name?"."+t.name:"";return t.container.trigger(e.Event("resize"+i),[t.container.width(),t.container.height()]).trigger(e.Event("resize"),[t.container.width(),t.container.height()]),t.layoutKids()},resize:function(i,n){var a=this;t.isPercent(i)&&(i=t.percentToPixels(a.windowEl,i,"width")),t.isPercent(n)&&(n=t.percentToPixels(a.windowEl,n,"height"));var r=a.container[0].scrollHeight,l=a.container.height(),o=a.header&&e.isNumeric(a.header.el.outerHeight())?a.header.el.outerHeight():0,s=a.footer&&e.isNumeric(a.footer.el.outerHeight())?a.footer.el.outerHeight():0,u=o+s,d=arguments.length?n:r+u>=e.viewportH()?e.viewportH()-10:r>=l&&!a.hasOwnProperty("height")?r+u:t.isPercent(a.height)?t.percentToPixels(a.windowEl,a.height,"height"):a.height;a.windowEl.css({height:d,width:arguments.length?i:void 0});var c=a.windowLeft?e.isNumeric(a.windowLeft)?a.windowLeft:t.percentToPixels(e("html"),a.windowLeft,"width"):Math.floor(e.viewportW()/2-a.windowEl.width()/2),h=a.windowTop?e.isNumeric(a.windowTop)?a.windowTop:t.percentToPixels(e("html"),a.windowTop,"height"):Math.floor(e.viewportH()/2-d/2);return a.windowEl.css({top:h,left:c}),a.fireResize(),{width:a.windowEl.outerWidth(),height:a.windowEl.outerHeight()}},cssByParam:function(){t.O.prototype.cssByParam.apply(this,arguments),this.isModal&&this.modalEl.css({width:"",height:""}),this.windowEl&&this.resize()},height:200,width:600}),t.msg=function(i,n,a,r){var l=[new t.O({el:e("<div>").addClass("wui-msg").html(i)})];"undefined"!=typeof r&&("function"==typeof r.push?l.push.apply(l,r):l.push(r));var o=new t.Window({title:n||"Message",isModal:!0,items:l,width:350,onWinClose:a||function(){}});return o},t.errRpt=function(i,n,a,r){var l=t.msg(i,n,r);return e.isArray(a)&&l.footer.push.apply(l.footer,a),l.container.find(".wui-msg").addClass("wui-err"),l.resize(),l},t.confirm=function(e,i,n){var a=t.msg.apply(this,arguments);return a.doAnswer=function(e){n&&"function"==typeof n&&n(e),a.answerRun=!0,a.close()},a.onWinClose=function(){return a.answerRun!==!0?!1:a.answerRun},a.footer.splice(0,1,new t.Button({text:"No",click:function(){a.doAnswer(!1)}}),new t.Button({text:"Yes",click:function(){a.doAnswer(!0)}})),a.header.splice(0,1),a.resize(),a}}(jQuery,Wui),function($,Wui){Wui.Tabs=function(e){$.extend(this,{bbar:[],items:[],tabsLeft:!1,currentTab:null,tabsBottom:!1,tabsHideHeader:null,tbar:[]},e),this.init()},Wui.Tabs.prototype=$.extend(new Wui.Pane,{place:function(){var e=this;return e.el.addClass("wui-tabs"),void 0===e.items&&(e.items=[]),$.each(e.items,function(t,i){i.tabCls="wui-tab "+(i.tabCls?" "+i.tabCls:"")+(e.tabsLeft?" left":""),i.tabsHideHeader&&i.el.addClass("wui-hide-heading"),e[e.tabsBottom?"footer":"header"].push(i.tab=new Wui.Button({text:i.title||"Tab "+(parseInt(t)+1),click:function(){e.giveFocus(i)},cls:i.tabCls}))}),Wui.O.prototype.place.call(e,function(e){$.each(e.items,function(e,t){t.el.addClass("wui-tab-panel")})})},giveFocus:function(e,t){var i=this,n=i.name?"."+i.name:"";t=void 0!==t?t:!1,$.each(i.items,function(a,r){var l=r===e;r.tab.el.toggleClass("selected",l),r.el.toggleClass("active",l),l&&(i.currentTab=r,t||i.el.trigger($.Event("tabchange"),[i,r.tab,r]).trigger($.Event("tabchange"+n),[i,r.tab,r]),r.layout())})},selectTabByText:function(e,t){var i,n=this;return $.each(n.items,function(a,r){$.trim(r.tab.el.text()).toLowerCase()===$.trim(e).toLowerCase().replace(/_/g," ")&&(n.giveFocus(r,t),i=r)}),i},onRender:function(){this.giveFocus(this.items[0])}}),Wui.Grid=function(e){$.extend(this,{bbar:[],columns:[],colUrl:null,colParams:{},colDataParams:{},data:null,defaultDataType:"string",multiSelect:!1,hideHeader:!1,selected:[],sort:[],tbar:[]},e),this.init()},Wui.Grid.prototype=$.extend(new Wui.DataList,new Wui.Pane,{afterMake:function(){this.layout(),this.removeMask()},closeSorter:function(){this.dd.children("li").off("click").end().hide()},doSort:function(e,t,i){var n=this;if(n.sorters.length>0){var a=n.sorters[e],r=t.rec[a.dataItem],l=i.rec[a.dataItem],o="asc"==a.sortDir?1:-1,s=0;switch(a.dataType){case"date":r=new Date(r),l=new Date(l),s=r.getTime()==l.getTime()?0:r.getTime()>l.getTime()?1:-1;break;case"numeric":r=parseFloat(r)?parseFloat(r):0,l=parseFloat(l)?parseFloat(l):0,s=r==l?0:r>l?1:-1;break;default:s=$.trim(r).toUpperCase().localeCompare($.trim(l).toUpperCase())}return 0!==s||void 0===n.sorters[e+1]?s*o:n.doSort(e+1,t,i)}return t.rec.wuiIndex>i.rec.wuiIndex?1:-1},getColumns:function(){var e=this;if(e.colUrl&&e.colUrl.length)e.colProxy=new Wui.Data($.extend({url:e.colUrl,params:e.colParams,afterSet:function(t){e.setColumns(t)}},e.colDataParams)),e.colProxy.loadData();else if(e.columns.length)return e.setColumns(e.columns)},init:function(){var e=this;Wui.Pane.prototype.init.call(e),e.el.addClass("wui-grid"),e.tblContainer=$("<div><table></table></div>").addClass("grid-body").appendTo(e.elAlias),e.headingContainer=$("<div><ul></ul></div>").addClass("wui-gh").appendTo(e.elAlias),e.elAlias=e.tbl=e.tblContainer.children("table"),e.heading=e.headingContainer.children("ul"),e.cols=[],e.sorters=[],$("body").append(e.dd=$("<ul><li>Ascending</li><li>Decending</li><li>No Sort</li><ul>").addClass("wui-sort-menu").attr({id:e.idCls=Wui.id()}).on("mousewheel scroll",function(e){e.stopPropagation()})),$(document).on("click","*:not(#"+e.idCls+")",function(){e.closeSorter()}),e.hideHeader&&e.headingContainer.height(0)},layout:function(){if(Wui.O.prototype.layout.apply(this,arguments),this.fitToContent===!0){var e=this,t=e.header.el.outerHeight()+e.footer.el.outerHeight(),i=$.isNumeric(e.maxHeight)?e.maxHeight:0,n=e.headingContainer.outerHeight();e.tblContainer.children().each(function(){n+=$(this).outerHeight()}),n=i>0&&n+t>i?i:n,e.height=n+t,Wui.O.prototype.layout.apply(e,arguments)}this.posDataWin(),this.cols.length&&this.sizeCols()},loadData:function(){return this.setMaskHTML('Loading <span class="wui-spinner"></span>'),this.addMask(),Wui.Data.prototype.loadData.apply(this,arguments)},mngSorters:function(e,t){var i=this,n=["one","two","three","four","five"];if(void 0!==e)if(void 0!==t){var a=!0;for(r=i.sorters.length;r>0;r--)i.sorters[r-1].dataItem==e.dataItem&&(a=!1);e.sortDir=t,a&&i.sorters.push(e)}else if(e.sortDir)if("desc"==e.sortDir){delete e.sortDir,e.el.removeClass().addClass("wui-gc").addClass(e.cls);for(var r=i.sorters.length;r>0;r--)i.sorters[r-1].el==e.el&&i.sorters.splice(r-1,1)}else e.sortDir="desc";else{if(i.sorters.length>5)return e.el.removeClass().addClass("wui-gc").addClass(e.cls),!1;e.sortDir="asc",i.sorters.push(e)}$.each(i.sorters,function(e,t){t.el.removeClass().addClass("wui-gc "+n[e]+" "+t.sortDir).addClass(t.cls)})},modifyItem:function(e){var t=this;return $.each(t.renderers,function(i,n){var a=e.el.children(":eq("+n.index+")").children("div"),r=e.rec[n.dataItem];a.empty().append(n.renderer.call(null,a,r,e.rec,e.el,t))}),e.el},onRender:function(){var e=this,t=e.autoLoad;return e.autoLoad=!1,Wui.DataList.prototype.onRender.call(this),e.autoLoad=t,this.getColumns()},posDataWin:function(){var e=this.headingContainer.height()-1;

this.tblContainer.css({height:this.container.height()-e,top:e})},configBar:function(){Wui.Pane.prototype.configBar.apply(this,arguments),this.posDataWin()},refresh:function(){return null!==this.url?this.getColumns():void this.setData(this.data)},renderColumn:function(col,idx){var me=this;$.extend(col,{dataType:col.dataType||me.defaultDataType,fit:void 0===col.fit?void 0===col.width?1:-1:col.fit,cls:col.cls||"",renderer:col.renderer?function(a){"function"!=typeof a&&"function"==eval("typeof "+a)&&(a=new Function("return "+a+".apply(this,arguments)")),"function"==typeof a&&me.renderers.push({dataItem:col.dataItem,renderer:a,index:idx})}(col.renderer):"",index:idx,resizable:"undefined"==typeof col.resizable?!0:col.resizable,sortable:"undefined"==typeof col.sortable?!0:col.sortable,width:void 0===col.width?0:col.width,el:$("<li>").append($("<div>").text(col.heading)).attr({unselectable:"on"}).addClass("wui-gc").addClass(col.cls)}),col.sortable?(col.el.on("contextmenu",function(e){e.preventDefault(),Wui.positionItem($(this),me.dd),$("body").append(me.dd.width(100).show()),Wui.positionItem($(this),me.dd),me.dd.children("li").on("click",function(){var e={Ascending:function(){me.mngSorters(col,"asc")},Decending:function(){me.mngSorters(col,"desc")},"No Sort":function(){col.sortDir="desc",me.mngSorters(col)}};e[$(this).text()](),me.closeSorter(),me.runSort()})}),col.el.click(function(){me.sortList(col)})):col.el.addClass("wui-no-sort"),me.columns.length>1&&!col.vertical&&col.resizable&&col.el.resizable({handles:"e",start:function(){me.tempLayout=me.layout,me.layout=function(){}},stop:function(){me.sizeCols(),me.layout=me.tempLayout},resize:function(e,t){col.width=t.size.width,col.fit=-1,Wui.fit(me.cols,"width")}}),me.cols.push(col),me.heading.append(col.el)},runSort:function(){var e=this,t=e.items;t.sort(function(t,i){return e.doSort(0,t,i)}),e.tbl.detach(),$.each(t,function(t,i){i.el.appendTo(e.tbl)}),e.tbl.appendTo(e.tblContainer),e.sizeCols()},push:function(){var e=Wui.Data.prototype.push.apply(this,arguments);return this.sizeCols(),e},splice:function(){var e=Wui.Data.prototype.splice.apply(this,arguments);return this.sizeCols(),e},setColumns:function(e){var t=this;if(t.columns=e,t.heading.empty(),t.cols=[],t.items=[],t.renderers=[],t.template="<tr>",$.each(e,function(e,i){var n=i.dataTemplate?i.dataTemplate:i.dataItem?"{"+i.dataItem+"}":"";t.template+="<td><div>"+n+"</div></td>",i.vertical&&(t.el.addClass("has-vert-columns"),i.cls?i.cls+=" vert-col":i.cls="vert-col",i.width=50,delete i.fit),t.renderColumn(i,e)}),t.template+="</tr>",t.sorters&&t.sorters.length&&t.cols.length)for(var i=t.sorters.length-1;i>=0;i--){for(var n=!0,a=0;a<t.cols.length;a++)if(t.cols[a].dataItem==t.sorters[i].dataItem){t.sorters[i].el=t.cols[a].el,t.cols[a].sortDir=t.sorters[i].sortDir,n=!1;break}n&&t.sorters.splice(i,1)}return t.getSrcData()},getSrcData:function(){var e=this;if(e.autoLoad){if(null!==e.url)return e.loadData();e.setData(e.data)}},setData:function(){var e=this,t=null,i=null;if(Wui.DataList.prototype.setData.apply(e,arguments),e.sort.length&&!e.sorters.length)for(t=0;t<e.sort.length;t++)for(i=0;i<e.cols.length;i++)e.cols[i].dataItem==e.sort[t].dataItem&&e.mngSorters(e.cols[i],e.sort[t].order);this.sortList()},sizeCols:function(){var e=this,t=e.headingContainer,i=e.tbl.find("tr:first").height()*e.total>e.tblContainer.height(),n=i?Wui.scrollbarWidth():0;t.css("padding-right",n),Wui.fit(e.cols,"width");for(var a=0;a<e.cols.length;a++)e.tbl.find("td:eq("+a+")").css({width:e.cols[a].el.innerWidth()});e.tbl.css({width:t.width(),tableLayout:"fixed"})},sortList:function(e){var t=this;t.mngSorters(e),t.runSort()}}),Wui.InfiniteGrid=function(e){$.extend(this,{data:null,sort:null,paging:null},e),this.init()},Wui.InfiniteGrid.prototype=$.extend(new Wui.Grid,{addRows:function(e){var t=this,i=e||[],n=$("<div>");t.items=[];for(var a=0;t.displayMax<0&&a<i.length||t.displayMax>0&&a<t.displayMax&&a<i.length;a++){var r=t.data=i[a],l={el:Wui.Template.prototype.make.call(t,a),rec:r};Array.prototype.push.call(t.items,l),n.append(t.createItem(l))}return t.tbl.empty(),t.tbl.append(n.children().unwrap()),t.data=i,e},afterSet:function(e){var t=this;t.isPaging&&t.tbl.children().length>0&&t.total>t.data.length&&(t.addRows(e),t.rowHeight=t.tbl.find("tr:first").outerHeight(),t.tbl.css({top:t.params.start*t.rowHeight+"px"}),t.sizeCols())},alignPagingSort:function(){var e=this;0===e.sorters.length&&(e.paging.sort=e.originalSort),$.each(e.paging.sort,function(t,i){$.each(e.columns,function(t,n){n.dataItem===i.dataItem&&e.mngSorters(n,i.order)})})},getSrcData:function(){var e=this;return e.initLoaded!==!0&&null!==e.data?(e.setParams(e.params),e.setData(e.data)):Wui.Grid.prototype.getSrcData.apply(e,arguments)},init:function(){var e=this;Wui.Pane.prototype.init.call(e),e.el.addClass("wui-grid wui-infinite-grid"),e.tblContainer=$("<div><div>&nbsp;</div><table></table></div>").addClass("grid-body"),e.headingContainer=$("<div><ul></ul></div>").addClass("wui-gh"),e.tbl=e.tblContainer.children("table").addClass("wui-infinite-table"),e.tblHSize=e.tblContainer.children("div").addClass("wui-ghs"),e.heading=e.headingContainer.children("ul"),e.sorters=[],e.renderers=[],e.originalSort=e.paging.sort||null,e.tblContainer.scroll(function(){e.isPaging&&e.pagingScroll(),e.headingContainer.scrollLeft($(this).scrollLeft())}),e.elAlias.append(e.tblContainer,e.headingContainer),e.hideHeader&&e.headingContainer.height(0)},make:function(){var e=this;e.addRows(e.data),e.isPaging&&(e.rowHeight=e.tbl.find("tr:first").outerHeight(),e.totalPages=Math.floor(e.total/e.paging.limit),e.alignPagingSort(),e.totalHeight=e.total*e.rowHeight,e.tblHSize&&e.tblHSize.height(e.totalHeight)),e.autoLoad=!0,e.afterMake(),e.el.trigger($.Event("refresh"),[e,e.data])},mngSorters:function(e,t){var i=this,n=0,a=["one","two","three","four","five"];if(void 0!==e)if(void 0!==t){var r=!0;for(n=i.sorters.length;n>0;n--)i.sorters[n-1].dataItem==e.dataItem&&(r=!1);e.sortDir=t,r&&i.sorters.push(e)}else if(e.sortDir)if("desc"==e.sortDir.toLowerCase())for(delete e.sortDir,e.el.removeClass().addClass("wui-gc").addClass(e.cls),n=i.sorters.length;n>0;n--)i.sorters[n-1].el==e.el&&i.sorters.splice(n-1,1);else e.sortDir="desc";else{if(i.sorters.length>5)return e.el.removeClass().addClass("wui-gc").addClass(e.cls),!1;e.sortDir="asc",i.sorters.push(e)}i.isPaging&&(i.paging.sort=[],0===i.sorters.length&&i.alignPagingSort()),i.sorters.forEach(function(e,t){e.el.removeClass().addClass("wui-gc "+a[t]+" "+e.sortDir.toLowerCase()).addClass(e.cls),i.isPaging&&i.paging.sort.push({dataItem:e.dataItem,order:e.sortDir})})},pagingScroll:function(){var e=this,t=e.tblContainer.scrollTop(),i=Math.round(e.totalPages*(t/e.totalHeight)),n=function(){e.tbl.css({top:e.actualStart*e.rowHeight+"px"}),e.currPage!=Math.floor((e.tblContainer.scrollTop()+e.tblContainer.height())/(e.totalHeight/e.totalPages))&&e.pagingScroll(),e.sizeCols()};e.currPage=e.currPage||0,e.lastScroll=t,$.isNumeric(i)&&e.currPage!=i&&(e.paging.start=i*e.paging.limit,e.currPage=i,e.actualStart=i*e.paging.limit+(0!==i?-1*Math.round(e.paging.limit/2):0),e.actualLimit=2*e.paging.limit,e.loadData({start:$.isNumeric(e.actualStart)?e.actualStart:0,limit:$.isNumeric(e.actualLimit)?e.actualLimit:50,sort:JSON.stringify(e.paging.sort)})),e.onSuccess!==n&&(e.onSuccess=n)},runSort:function(){var e=this;if(e.isPaging===!0)e.currPage=-1,e.tbl.scroll();else{var t=e.items;t.sort(function(t,i){return e.doSort(0,t,i)}),e.tbl.detach(),$.each(t,function(t,i){i.el.appendTo(e.tbl)}),e.tbl.appendTo(e.tblContainer),e.sizeCols(),e.resetSelect()}},scrollToCurrent:function(){this.isPaging||Wui.DataList.prototype.scrollToCurrent.apply(this,arguments)},setParams:function(){var e=this;return null!==e.paging&&"object"==typeof e.paging&&(e.isPaging=!0,$.extend(e.params,{limit:e.paging.limit,start:e.paging.start,sort:JSON.stringify(e.paging.sort)}),"object"==typeof arguments[0]&&"undefined"==typeof arguments[0].start&&$.extend(arguments[0],{start:0})),Wui.Data.prototype.setParams.apply(e,arguments)},setData:function(){Wui.DataList.prototype.setData.apply(this,arguments),this.isPaging||this.sortList(),this.sizeCols()}}),Wui.Form=function(e){$.extend(this,{disabled:!1,labelPosition:"top",labelSize:null},e,{formChanged:!1,el:$("<div>").addClass("wui-form"),errors:[]}),this.init()},Wui.Form.prototype=$.extend(new Wui.O,{clearData:function(){this.setData()},dispErrors:function(){for(var e="",t=0;t<this.errors.length;t++)e+=this.errors[t]+"<br/>";Wui.errRpt(e,"Form Errors")},each:function(e,t,i){return Wui.O.prototype.each.call(this,function(i,n){return!t||i instanceof Wui.FormField?e(i,n):void 0},i)},errCls:"wui-form-err",getData:function(){return this.validate()?this.getRawData():(this.dispErrors(),!1)},getField:function(e){var t=null;return this.each(function(i){i.name==e&&(t=i.val())}),t},getFrmItm:function(e){var t;return this.each(function(i){i.name==e&&(t=i)}),t},getRawData:function(){var e={};return this.each(function(t){e[t.name]=t.val()},!0),e},init:function(){},normFrmItem:function(e){var t=this;if(e.disabled&&e.disabled===!0||$.extend(e,{disabled:t.disabled}),e.hasOwnProperty("labelPosition")||$.extend(e,{labelPosition:t.labelPosition}),!e.ftype||e instanceof Wui.FormField)return e instanceof Wui.FormField?(e.lbl&&(e.labelSize=e.labelSize||t.labelSize,e.lbl.setLabelPosition(e.labelPosition||t.labelPosition),e.lbl.setLabelSize(e.labelSize||t.labelSize)),e):e;var i=e.ftype.split(".");switch(e.labelSize=e.labelSize||t.labelSize,i.length){case 1:if(window[i[0]])return new window[i[0]](e);throw"Object type "+e.ftype+" is not defined.";case 2:if(window[i[0]]&&window[i[0]][i[1]])return new window[i[0]][i[1]](e);throw"Object type "+e.ftype+" is not defined.";case 3:if(window[i[0]]&&window[i[0]][i[1]][i[2]])return new window[i[0]][i[1]][i[2]](e);throw"Object type "+e.ftype+" is not defined.";case 4:if(window[i[0]]&&window[i[0]][i[1]][i[2]][i[3]])return new window[i[0]][i[1]][i[2]][i[3]](e);throw"Object type "+e.ftype+" is not defined.";default:throw"Object type "+e.ftype+" is not defined."}},place:function(){var e=this;return void 0===e.items&&(e.items=[]),e.each(function(t,i){e.items[i]=e.normFrmItem(t)}),Wui.O.prototype.place.apply(this,arguments)},push:function(){var e=this,t=[];return $.each(arguments,function(i,n){t.push(e.normFrmItem(n))}),Wui.O.prototype.push.apply(this,t)},splice:function(){var e=this,t=[],i=Array.prototype.shift.apply(arguments),n=Array.prototype.shift.apply(arguments);return $.each(arguments,function(i,n){t.push(e.normFrmItem(n))}),t.splice(0,0,i,n),Wui.O.prototype.splice.apply(this,t)},remFrmItm:function(e){var t=this;return this.each(function(i,n){i.name==e&&Wui.O.prototype.splice.call(t,n,1)}),!0},formChange:function(e,t){var i=this,n=i.name?"."+i.name:"";return e&&i.el.trigger($.Event("formupdate"),[i,t]).trigger($.Event("formupdate"+n),[i,t]),i.formChanged=e,i.formChanged},setData:function(e,t){e?(this.setData(),this.each(function(i){e[i.name]&&i.val(e[i.name],t)},!0)):this.each(function(e){e.val(null,t)},!0),this.formChange(!1)},disable:function(){return this.disabled=!0,this.each(function(e){e.disable()},!0)},enable:function(){return this.disabled=!1,this.each(function(e){e.enable()},!0)},setField:function(e,t){this.each(function(i){i.name==e&&i.val(t)},!0)},throwError:function(e){return this.errors.push(e),!1},validate:function(){var e=this;return e.errors=[],e.each(function(t){"undefined"!=typeof t.el.toggleClass&&t.el.toggleClass(e.errCls,!t.validate())},!0),this.formChange(!1),0===e.errors.length}}),Wui.Note=function(e){$.extend(this,{html:""},e),this.init()},Wui.Note.prototype=$.extend(new Wui.O,{init:function(){this.el=$("<div>").html(this.html).addClass("wui-note")}}),Wui.Label=function(e){$.extend(this,{html:"",labelPosition:"top",labelSize:null},e),this.init()},Wui.Label.prototype=$.extend(new Wui.O,{init:function(){var e=this;e.el=$("<div>").addClass("wui-lbl").append(e.label=$("<label>").addClass(e.cls).attr(e.attr?e.attr:{})),e.setLabel(),e.setLabelPosition()},setLabel:function(e){return e=e||this.html,this.label.html(this.html=e),this.label.html()},verifyPosition:function(e){return e&&(e=e.toLowerCase())&&$.inArray(e,["top","left","bottom","right"])>=0?e:this.labelPosition},setLabelSize:function(e){var t=this;if(e=$.isNumeric(e)?e:t.labelSize,t.el.css({paddingLeft:"",paddingRight:"",paddingTop:"",paddingBottom:""}),t.label.css({width:"",height:"",marginLeft:"",marginRight:""}),$.isNumeric(e)){var i="height"==n?0:parseInt("left"==t.labelPosition?t.label.css("margin-right"):t.label.css("margin-left")),n=$.inArray(t.labelPosition,["top","bottom"])>=0?"height":"width";t.el.css("padding-"+t.labelPosition,e),isNaN(i)&&(i=5),t.label.css(n,e-i),t.field&&(t.field.labelSize=t.labelSize=e)}t.adjustField()},adjustField:function(){var e=this,t=$.inArray(e.labelPosition,["top","bottom"])>=0?"height":"width";e.field&&"width"==t&&e.label.outerHeight()>e.field.el.height()&&e.field.el.css("min-height",e.label.outerHeight())},setLabelPosition:function(e){var t=this;return e=t.verifyPosition(e),t.el.removeClass("lbl-"+t.labelPosition).addClass("lbl-"+e),t.field&&(t.field.labelPosition=e),t.labelPosition=e,t.setLabelSize(),t.labelPosition}}),Wui.FormField=function(e){$.extend(this,{disabled:!1,invalidMsg:null,label:null,labelCls:null,labelSize:null,required:!1,validRegEx:null,validTest:null},e)},Wui.FormField.prototype=$.extend(new Wui.O,{labelPosition:"top",init:function(){var e=this;return e.value=e.hasOwnProperty("value")?e.value:null,e.el=$("<div>").addClass("wui-fe"),e.label&&e.label.length>0&&(e.lbl=new Wui.Label({html:e.label,cls:e.labelCls,field:e,labelPosition:e.labelPosition,labelSize:e.labelSize}),e.elAlias=e.el,e.el=e.lbl.el.append(e.elAlias)),e.el},onRender:function(){this.disabled&&this.disable(),this.hasOwnProperty("value")&&this.val(this.value,!1)},afterRender:function(){this.lbl&&this.lbl.adjustField()},disable:function(){this.disabled=!0,this.el&&this.el.addClass&&this.el.addClass("wui-disabled").find("input,textarea,iframe").attr({readonly:!0,tabIndex:-1})},enable:function(){this.disabled=!1,this.el&&this.el.addClass&&this.el.removeClass("wui-disabled").find(".wui-disabled,*[readonly]").removeAttr("readonly tabIndex")},validate:function(){function e(){return"undefined"!=typeof t.parent.throwError?t.parent.throwError(a):!1}var t=this,i=t.val(),n=null!==t.label?t.label:"undefined"!=typeof t.name?t.name:null,a=null!==t.invalidMsg?t.invalidMsg:null!==n?"A value for '"+n+"' is required.":"A required field has an improper value.";if(t.validTest&&"function"==typeof t.validTest&&t.validTest(i)===!1)return e();if($.isNumeric(t.maxChars)&&i&&i.length>t.maxChars)return a=n&&$.trim(n).length?"'"+n+"' must be less than "+t.maxChars+" characters.":"You have a field with too many characters in it, the max is "+t.maxChars+".",e();if(null!==t.validRegEx&&!t.validRegEx.test($.trim(i)))return e();if(t.required){if(null===i||void 0===i)return e();if("string"==typeof i&&0===$.trim(i).length)return e()}return!0},val:function(){if(arguments.length){var e=this.value;return this.setVal.apply(this,arguments),arguments[1]!==!1&&this.setChanged(e),arguments}return this.getVal()},setChanged:function(e){var t=this,i=t.name?"."+t.name:"";t.parent&&t.parent instanceof Wui.Form&&t.parent.formChange(!0,t),t.valChange(t,t.value,e),t.el?t.el.trigger($.Event("valchange"),[t,t.value,e]).trigger($.Event("valchange"+i),[t,t.value,e]):t.parent&&t.parent instanceof Wui.Form&&t.parent.el.trigger($.Event("hiddenchange"),[t,t.value,e]).trigger($.Event("hiddenchange"+i),[t,t.value,e])},getVal:function(){return this.value},setVal:function(e){this.value=e},valChange:function(){}}),Wui.Hidden=function(e){$.extend(this,{el:$("<div>").hide()},e),this.init()},Wui.Hidden.prototype=$.extend(new Wui.FormField,{init:function(){}}),Wui.Text=function(e){$.extend(this,{blankText:"",counter:!1,maxChars:null},e,{field:$("<input>").attr({type:"text"})}),this.init()},Wui.Text.prototype=$.extend(new Wui.FormField,{init:function(){var e=this;Wui.FormField.prototype.init.call(e),e.blankText&&e.blankText.length&&e.setBlankText(e.blankText),e.append(Wui.Text.prototype.setListeners.call(e,e))},setBlankText:function(e){var t=this;return t.blankText=e,t.field.attr("placeholder",e),e},setListeners:function(e){var t=this,i=null;return e.field.focusin(function(){i=t.field.val()}).blur(function(){i!=t.field.val()&&(t.val(),t.setChanged())}),$.isNumeric(e.maxChars)&&e.counter===!0&&(e.append(e.charCounter=$("<div>").addClass("wui-char-counter")),e.field.keyup(function(){var t=e.val()?e.maxChars-e.val().length:e.maxChars;e.charCounter.text(t),t>=0?e.charCounter.css("color","#333"):e.charCounter.css("color","#900")}),e.field.keyup()),this.setListeners!==Wui.Text.prototype.setListeners&&this.setListeners(this),e.field},fieldText:function(e){this.field.val(e)},getVal:function(){return this.value=this.field.val()&&this.field.val().length?this.field.val():null,this.value},setVal:function(e){this.fieldText(this.value=e&&$.trim(e).length?e:null)}}),Wui.Textarea=function(e){$.extend(this,{field:$("<textarea>"),height:80},e),this.init()},Wui.Textarea.prototype=$.extend(new Wui.Text,{init:function(){var e=this;Wui.Text.prototype.init.call(e)},cssByParam:function(){Wui.O.prototype.cssByParam.apply(this,arguments);var e=this.lbl&&$.inArray(this.lbl.labelPosition,["top","bottom"])>=0?this.lbl.label.outerHeight():0;this.el.css({height:"",minHeight:this.height}),this.field.css({height:"",minHeight:this.height-e})}}),Wui.Wysiwyg=function(e){$.extend(this,{css:"body {color:#333;font:90%  Arial, Verdana, Helvetica,sans-serif;overflow:auto;margin:0;padding:0;}a {color:#09c; text-decoration:none;}a:hover {color:#0c9; text-decoration:underline;}",showHTML:!1,fullPath:/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,relativePath:/(\/|\/([\w#!:.?+=&%@!\-\/]))/},e,{}),this.init()},Wui.Wysiwyg.prototype=$.extend(new Wui.FormField,{init:function(){var e=this;Wui.FormField.prototype.init.call(e),e.el.addClass("wui-wysiwyg"),e.append(e.iframe=$("<iframe>").addClass("wui-editor"),e.tools=$("<div>").addClass("wui-editor-tools")),e.tools.append(e.bold=$("<a>").addClass("bold").attr({tabIndex:-1,title:"Bold"}),e.italic=$("<a>").addClass("italic").attr({tabIndex:-1,title:"Italic"}),e.underline=$("<a>").addClass("underline").attr({tabIndex:-1,title:"Underline"}),e.strike=$("<a>").addClass("strikethrough").attr({tabIndex:-1,title:"Strike-through"}),e.link=$("<a>").addClass("link").attr({tabIndex:-1,title:"Link"}),e.unlink=$("<a>").addClass("unlink").attr({tabIndex:-1,title:"Un-Link"}),e.ul=$("<a>").addClass("unorderedlist").attr({tabIndex:-1,title:"Unorderd List"}),e.ol=$("<a>").addClass("orderedlist").attr({tabIndex:-1,title:"Ordered List"}),e.left=$("<a>").addClass("justifyleft").attr({tabIndex:-1,title:"Left Align"}),e.center=$("<a>").addClass("justifycenter").attr({tabIndex:-1,title:"Center Align"}),e.right=$("<a>").addClass("justifyright").attr({tabIndex:-1,title:"Right Align"})),e.showHTML&&e.tools.append($("<a>").addClass("html").attr({tabIndex:-1,title:"Toggle HTML View"}))},disable:function(){Wui.FormField.prototype.disable.call(this),Wui.Pane.prototype.addMask.call(this,this.elAlias||this.el)},enable:function(){Wui.FormField.prototype.enable.call(this),Wui.Pane.prototype.removeMask.call(this)},onRender:function(){var e=this,t=e.editor=e.iframe[0].contentWindow.document;t.designMode="on",t.open(),t.close(),e.css.length&&$("head",t).append($("<style>").attr({type:"text/css"}).text(e.css)),Wui.FormField.prototype.onRender.call(e),e.bold.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("bold")}),e.italic.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("italic")}),e.underline.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("underline")}),e.strike.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("strikethrough")}),e.link.mousedown(function(){e.previousRange=e.getRange()}).click(function(){var t=e.previousRange;if(t.htmlText)e.exec("createLink",!0);else{var i=Wui.input("Link URL:",function(t){e.exec("createLink",!1,t),i.parent.closeOkay=!0,i.parent.close()},"Insert Link",[{ftype:"Wui.Text",blankText:"Use: 'http://...'    or   '/directory/page/etc...' ",required:!0,invalidMsg:"You need to have a properly formatted link with either an absolute or relative path.",testLink:function(){return this.validTest(this.field.val())},validTest:function(t){return e.fullPath.test(t)||e.relativePath.test(t)},setListeners:function(){var e=this;return e.field.on("blur click keyup keydown mousedown",function(){Wui.Link.prototype.buildOutput.call(e,{uri:e.field.val(),target:"_blank",title:t.toString()})})}}]);setTimeout(function(){i.parent.modalEl.css("z-index",Wui.maxZ())},100)}}),e.unlink.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("unlink",!1,[])}),e.ol.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("insertunorderedlist")}),e.ul.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("insertorderedlist")}),e.left.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("justifyLeft")}),e.center.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("justifyCenter")}),e.right.mousedown(function(){e.previousRange=e.getRange()}).click(function(){e.exec("justifyRight")}),$(t.body).children().length||e.exec("insertHTML",!1," "),(e.elAlias||e.el).resizable()},exec:function(e,t,i){if(this.iframe[0].contentWindow.focus(),this.previousRange){var n=this.previousRange,a=this.getSelection();a.removeAllRanges(),a.addRange(n)}this.editor.execCommand(e,t||!1,i||null)},getRange:function(){var e=this.getSelection();return e?e.getRangeAt&&e.rangeCount>0?e.getRangeAt(0):e.createRange?e.createRange():null:null},getSelection:function(){return this.editor.selection?this.editor.selection:this.iframe[0].contentDocument.defaultView.getSelection()},getVal:function(){var e=$.trim(this.editor.body.innerHTML.replace(/MsoNormal/gi,"").replace(/<\/?link[^>]*>/gi,"").replace(/<\/?meta[^>]*>/gi,"").replace(/<\/?xml[^>]*>/gi,"").replace(/<\?xml[^>]*\/>/gi,"").replace(/<!--(.*)-->/gi,"").replace(/<!--(.*)>/gi,"").replace(/<!(.*)-->/gi,"").replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,"").replace(/<w:[^>]*\/>/gi,"").replace(/<\/?w:[^>]*>/gi,"").replace(/<m:[^>]*\/>/gi,"").replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,"").replace(/<o:[^>]*>([.|\s]*)<\/o:[^>]*>/gi,"").replace(/<o:[^>]*>/gi,"").replace(/<o:[^>]*\/>/gi,"").replace(/<\/o:[^>]*>/gi,"").replace(/<\/?m:[^>]*>/gi,"").replace(/style=\"([^>]*)\"/gi,"").replace(/style=\'([^>]*)\'/gi,"").replace(/class=\"(.*)\"/gi,"").replace(/class=\'(.*)\'/gi,"").replace(/<p[^>]*>/gi,"<p>").replace(/<\/p[^>]*>/gi,"</p>").replace(/<span[^>]*>/gi,"").replace(/<\/span[^>]*>/gi,"").replace(/<st1:[^>]*>/gi,"").replace(/<\/st1:[^>]*>/gi,"").replace(/<font[^>]*>/gi,"").replace(/<\/font[^>]*>/gi,"").replace(/[\r\n]/g," ").replace(/<wordPasteong><\/wordPasteong>/gi,"").replace(/<p><\/p>/gi,"").replace(/\/\*(.*)\*\//gi,"").replace(/<!--/gi,"").replace(/-->/gi,"").replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,"").replace(/<hr>/gi,""));return this.value=0===e.length?null:e,this.value},setVal:function(e){var t=this;t.value=e,$(t.editor.body).html(e)}}),Wui.Radio=function(e){$.extend(this,{buttonStyle:!1,name:"wui-radio",options:[],template:'<li><input type="radio" id="{id}" value="{val}" name="{name}" /><label for="{id}">{title}</label></li>'},e,{el:$("<div>")}),this.init()},Wui.Radio.prototype=$.extend(new Wui.FormField,{init:function(){Wui.FormField.prototype.init.call(this),this.el.addClass("wui-radio");var e=this,t=new Wui.Template({template:this.template}),i=$("<ul>");$.each(e.options,function(n,a){a.name=e.name,a.id=Wui.id(),i.append(t.make(t.data=a).children("label").attr({unselectable:"on"}).keyup(function(e){(13==e.keyCode||32==e.keyCode)&&$(this).click()}).end().children("input").change(function(){e.elemChange($(this))}).focus(function(){i.addClass("has-focus")}).blur(function(){i.removeClass("has-focus")}).end())}),e.buttonStyle&&(i.addClass("button"),i.find("label").attr({tabindex:0})),e.append(i)},disable:function(){this.disabled=!0,this.el&&this.el.addClass&&this.el.addClass("wui-disabled").find("input,textarea,iframe").attr("disabled","disabled")},elemChange:function(e){this.val(e.val())},enable:function(){this.disabled=!1,this.el&&this.el.addClass&&this.el.removeClass("wui-disabled").find(".wui-disabled,*[disabled]").removeAttr("disabled")},onRender:function(){var e=this;e.el.find("input").each(function(){$(this).css({margin:"0 5px 0"+(e.buttonStyle?-1:0)*(5+$(this).outerWidth())+"px"})}),Wui.FormField.prototype.onRender.call(e)},getVal:function(){return this.value},setVal:function(e){this.value=e,this.el.find("input[value='"+e+"']").attr("checked",!0)}}),Wui.Checkbox=function(e){$.extend(this,{name:"wui-checkbox",template:'<li><input type="checkbox" id="{id}" value="{val}" name="{name}" /><label for="{id}">{title}</label></li>'},e),this.init()},Wui.Checkbox.prototype=$.extend(new Wui.Radio,{calcVal:function(){var e=this,t=[];return e.el.find("input:checked").each(function(){t.push($(this).val())}),t.length>0?t.length>1?t:t[0]:null},elemChange:function(){this.val(this.calcVal())},init:function(){var e=this;if(0===e.options.length&&e.options.push({val:1,title:""}),Wui.Radio.prototype.init.call(e),e.el.removeClass("wui-radio").addClass("wui-checkbox"),1==e.options.length){if(!e.label||!e.label.length)throw"Wui Forms - A Checkbox field "+(e.name?"('"+e.name+"')":"")+" requires a label if it doesn't have options defined.";e.el.find("li label").html(e.label),e.lbl.label.html(""),e.el.css({paddingTop:0,paddingBottom:0})}},getVal:function(){return this.calcVal()},setVal:function(e){var t=this;if(t.value=$.isArray(e)?e:null===e?null:[e],1!=t.options.length||"number"!=typeof e&&"string"!=typeof e){if(t.el.find("input").attr("checked",!1),t.el.find("label").removeClass("checked"),t.value&&t.value.length)for(var i=0;i<t.value.length;i++)t.el.find("input[value="+t.value[i]+"]").prop("checked",!0).siblings("li").addClass("checked")}else t.el.find("input").prop("checked",!!parseInt(e)).siblings("li").toggleClass("checked",!!parseInt(e))},validTest:function(){return this.required&&0===this.val()?!1:!0}}),Wui.Combo=function(e){if($.extend(this,{autoLoad:!1,ddCls:"",emptyMsg:"No Results.",field:$("<input>").attr({type:"text"}),filterField:!0,forceSelect:!1,minKeys:1,searchArgName:"srch",searchLocal:!0,showDD:!0,titleItem:null,valueItem:null},e,{multiSelect:!1}),(!this.hasOwnProperty("template")||null===this.template||void 0===this.template)&&this.hasOwnProperty("valueItem")&&this.hasOwnProperty("titleItem")&&this.valueItem&&this.titleItem&&(this.template="<li>{"+this.titleItem+"}</li>"),!this.template)throw new Error("Wui.js - valueItem and titleItem, or template, are required configs for a Combo.");this.init()},Wui.Combo.prototype=$.extend(new Wui.FormField,new Wui.DataList,{close:function(){this._open=!1,this.dd.hide()},hilightText:function(e){function t(e){return e.find(".wui-highlight").each(function(){$(this).replaceWith($(this).html())}).end()}function i(t){return t.children().length?t.children().each(function(){i($(this))}):t.html(t.text().replace(new RegExp(e,"ig"),function(e){return'<span class="wui-highlight">'+e+"</span>"})),t}var n=this;n.dd.children().each(function(){var n=$(arguments[1]);n.text().toUpperCase().indexOf(e.toUpperCase())>=0?i(n).show():t(n).hide()}),Wui.positionItem(n.field,n.dd)},init:function(){var e=this;Wui.FormField.prototype.init.call(e),e.el.addClass("wui-combo "+(e.idCls=Wui.id())),e._open=!1,e.identity=e.valueItem,"undefined"!=typeof e.blankText&&e.setBlankText(e.blankText),e.append(e.wrapper=$("<div>").addClass("wui-combo").append(e.setListeners(e))),$("body").append(e.dd=$("<ul>").addClass("wui-combo-dd "+e.ddCls).on("mousewheel scroll",function(e){e.stopPropagation()})),e.el.on({wuichange:function(t,i,n,a,r){var l=r.length?a[i.titleItem]:i.previous;Wui.Text.prototype.fieldText.call(e,l),t.stopPropagation()},click:function(e){e.stopPropagation()},wuiselect:function(e){e.stopPropagation()},wuideselect:function(e){e.stopPropagation()},datachanged:function(e){e.stopPropagation()},wuidblclick:function(e){e.stopPropagation()}}),e.showDD&&(e.ddSwitch=new Wui.Button({click:function(){e._open?e.close():e.open(),e.field.focus()},text:"",tabIndex:-1,appendTo:e.wrapper,cls:"field-btn dd-switch"}),e.ddSwitch.place(),e.ddSwitch.el.mousedown(function(){e.isBlurring=!1}))},itemSelect:function(e,t){var i=this;return i.dd.find(".wui-selected").removeClass("wui-selected"),e.el.addClass("wui-selected"),i.selected=[e],i.multiSelect||t||i.el.trigger($.Event("wuiselect"),[i,e.el,e.rec]).trigger($.Event("wuichange"),[i,e.el,e.rec,i.selected]),e},make:function(){var e=this;if(e.elAlias=e.dd.empty().removeClass("wui-spinner"),Wui.DataList.prototype.make.apply(e,arguments),0===e.data.length&&e.elAlias.html(e.emptyMsg),e.dd.children().off("click").bind("touchstart",function(){e.itemSelect($(this).data("itm")),e.isBlurring=!1}).on({mouseenter:function(){e.itemSelect($(this).data("itm"))},mousedown:function(){e.isBlurring=!1},click:function(){e.set(),e.field.focus()}}),e.previous&&e.previous.length&&e.hilightText(e.previous),e.dd.on("mousedown",function(){e.isBlurring=!1}),e.value&&0===e.field.val().length){var t=e.selectBy(e.valueItem,e.value);t?e.set():e.notFound(e.value)}Wui.positionItem(e.field,e.dd)},modifyItem:function(e){return e.el.data("itm",e)},notFound:function(){},afterRender:function(){this.afterRendered!==!0&&(Wui.FormField.prototype.onRender.apply(this,arguments),this.autoLoad&&null!==this.url?this.loadData():null===this.url&&this.make(),this.afterRendered=!0)},onRender:function(){},open:function(){var e=this,t=e.field.innerWidth()<100?100:e.field.innerWidth();e._open=!0,$(document).one("click","*:not(."+e.idCls+" input)",function(t){t.target!==e.field[0]&&e.close()}),$("body").append(e.dd.width(t).show()),Wui.positionItem(e.field,e.dd),e.scrollToCurrent()},searchData:function(e){var t=this,i=t.previous||void 0;if(t.filterField)if(t.previous=e,t.searchLocal)t.hilightText(e);else if(t.clearSelect(),(e.length>=t.minKeys||0===e.length)&&t.previous!=i){0===e.length&&t.val(null),t.dd.addClass("wui-spinner");var n={};n[t.searchArgName]=e,t.loadData(n)}},selectAjacent:function(e){var t=this,i=t._open?":visible":"",n=t.elAlias||t.el,a=1==e?":first":":last",r=1==e?"nextAll":"prevAll",l=t.selected.length?t.selected[0].el[r](i+":first"):n.children(i+a);return t.selectByEl(l)},selectBy:function(e,t){var i,n=this;return n.each(function(a){return void 0!==a.rec[e]&&a.rec[e]==t?i=n.itemSelect(a):void 0}),i},selectByEl:function(e){var t,i=this;return i.itemSelect(t=i.getItemByEl(e)),t},set:function(){var e=this;e.selected[0]&&e.value!=e.selected[0].rec&&e.val(e.selected[0].rec),e._open&&e.close()},setBlankText:function(){Wui.Text.prototype.setBlankText.apply(this,arguments)},setListeners:function(e){function t(t){var i=null;if(e.selected.length){var n=1==t?":last":":first",a=e._open?":visible":"",r=(e.elAlias||e.el).children(a+n)[0]==e.selected[0].el[0];r?e.clearSelect():i=e.selectAjacent(t)}else i=e.selectAjacent(t);e._open||(null!==i?e.set():(e.val(null),e.field.val(e.previous)))}return e.field.on({keydown:function(i){switch(0===e.field.val().length&&(e.value=null),i.keyCode){case 40:i.preventDefault(),t(1);break;case 38:i.preventDefault(),t(-1);break;case 9:e.set();break;case 27:i.preventDefault(),e.field.val(e.previous),e.close()}i.stopPropagation()},keyup:function(t){13==t.keyCode&&(t.preventDefault(),e.set()),t.stopPropagation()},input:function(){e._open||e.open(),e.searchData(this.value)},focus:function(t){e.isBlurring=void 0,t.stopPropagation()},blur:function(){e.isBlurring!==!1?e.close():setTimeout(function(){e.field.focus()},10)}})},setVal:function(e){var t=this;return t.value=e,null===e?(t.clearSelect(),e):"object"==typeof e?t.selectBy(t.valueItem,e[t.valueItem]):t.selectBy(t.valueItem,e);

},getVal:function(){return null!==this.value&&"undefined"!=typeof this.value[this.valueItem]?this.value[this.valueItem]:this.value}}),Wui.Link=function(e){$.extend(this,{invalidMsg:"The value for '"+(this.label?this.label:this.args&&this.args.name?this.args.name:"a link field")+"' is not a properly formatted link.",fullPath:/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,relativePath:/(\/|\/([\w#!:.?+=&%@!\-\/]))/},e),this.init()},Wui.Link.prototype=$.extend(new Wui.FormField,{buildOutput:function(e){var t=this,i=e||t.value;if(void 0===t.outputFld&&t.append(t.outputFld=$("<div>").attr({tabindex:-1}).addClass("feedback")),t.testLink()){var n=new Wui.Template({data:i,template:'<span>Preview:</span> <a href="{uri}" target="{target}" class="{((target == "_blank") ? "uri-new-win" : "")}">{title}</a>'});t.outputFld.html(n.make())}else i.uri&&i.uri.length>2?t.outputFld.html("Your link is improperly formatted."):t.outputFld.empty()},init:function(){var e=this;e.items=[e.urlField=new Wui.Text({cls:"wui-link-third wui-link-focus",blankText:"URL",linkData:"uri"}),e.titleField=new Wui.Text({cls:"wui-link-third",blankText:"Display Text",linkData:"title"}),e.targetField=new Wui.Combo({cls:"wui-link-third no-margin",valueItem:"target",titleItem:"name",blankText:"Target",keepInline:!0,data:[{target:"_self",name:"Opens In Same Window"},{target:"_blank",name:"Opens In New Window/Tab"}],linkData:"target"})],Wui.FormField.prototype.init.call(e),e.value={target:"_self",title:null,uri:null},e.el.append(e.elAlias=$("<div>").addClass("wui-hyperlink")),e.setListeners(e.urlField,e.titleField,e.targetField),e.targetField.val(e.value.target),e.urlField.field.keyup(function(){e.titleField.field.val()==e.titleField.blankText&&(e.value.title=null),null===e.value.title&&e.titleField.val($(this).val())}).blur(function(){e.value.title=e.titleField.val()})},setListeners:function(){var e=this,t=arguments;$.each(t,function(i,n){(n.field.field||n.field).on("blur click keyup keydown mousedown",null,n,function(t){var i=t.data.val();null!==i&&i!={}&&(e.value[t.data.linkData]=i),e.buildOutput.call(e)}).on("focus",null,n,function(e){$.each(t,function(e,t){t.el.removeClass("wui-link-focus")}),e.data.el.addClass("wui-link-focus")})})},testLink:function(){return this.fullPath.test(this.value.uri)||this.relativePath.test(this.value.uri)},getVal:function(){return this.value},setVal:function(e){$.extend(this.value,e),this.urlField.val(this.value.uri),this.titleField.val(this.value.title),this.targetField.val(this.value.target),this.buildOutput()},validTest:function(){return this.required&&!this.testLink()?!1:!0}}),Wui.Datetime=function(e){$.extend(this,e,{field:$("<input>").attr({type:"text"}),minDate:null,maxDate:null}),this.init()},Wui.dateExt!==!0&&(Wui.dateExt=!0,$.extend(Date,{CultureInfo:{name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM"},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,Date.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getTimezoneOffset:function(e,t){return t?Date.CultureInfo.abbreviatedTimeZoneDST[e.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[e.toUpperCase()]},getTimezoneAbbreviation:function(e,t){var i,n=t?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard;for(i in n)if(n[i]===e)return i;return null}}),$.extend(Date.prototype,{getDayOfYear:function(){var e=new Date(this.getFullYear(),0,0),t=this-e,i=864e5,n=Math.floor(t/i)-1;return n},getDaysInMonth:function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())},addMilliseconds:function(e){return this.setMilliseconds(this.getMilliseconds()+e),this},addSeconds:function(e){return this.addMilliseconds(1e3*e)},addMinutes:function(e){return this.addMilliseconds(6e4*e)},addHours:function(e){return this.addMilliseconds(36e5*e)},addDays:Date.prototype.addDays=function(e){return this.addMilliseconds(864e5*e)},addWeeks:function(e){return this.addMilliseconds(6048e5*e)},addMonths:function(e){var t=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(t,this.getDaysInMonth())),this},addYears:function(e){return this.addMonths(12*e)},add:function(e){if("number"==typeof e)return this._orient=e,this;var t=e;return(t.millisecond||t.milliseconds)&&this.addMilliseconds(t.millisecond||t.milliseconds),(t.second||t.seconds)&&this.addSeconds(t.second||t.seconds),(t.minute||t.minutes)&&this.addMinutes(t.minute||t.minutes),(t.hour||t.hours)&&this.addHours(t.hour||t.hours),(t.month||t.months)&&this.addMonths(t.month||t.months),(t.year||t.years)&&this.addYears(t.year||t.years),(t.day||t.days)&&this.addDays(t.day||t.days),this},getDayName:function(e){return e?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]},getMonthName:function(e){return e?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]},_toString:Date.prototype.toString,toString:function(e){var t=this,i=function(e){return 1==e.toString().length?"0"+e:e};return e?e.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(e){switch(e){case"hh":return i(t.getHours()<13?t.getHours():t.getHours()-12);case"h":return t.getHours()<13?t.getHours():t.getHours()-12;case"HH":return i(t.getHours());case"H":return t.getHours();case"mm":return i(t.getMinutes());case"m":return t.getMinutes();case"ss":return i(t.getSeconds());case"s":return t.getSeconds();case"yyyy":return t.getFullYear();case"yy":return t.getFullYear().toString().substring(2,4);case"dddd":return t.getDayName();case"ddd":return t.getDayName(!0);case"dd":return i(t.getDate());case"d":return t.getDate().toString();case"MMMM":return t.getMonthName();case"MMM":return t.getMonthName(!0);case"MM":return i(t.getMonth()+1);case"M":return t.getMonth()+1;case"t":return t.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return t.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return""}}):this._toString()}})),Wui.Datetime.prototype=$.extend(new Wui.Text,{second:1e3,minute:6e4,hour:36e5,day:864e5,days:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],shortDays:["sun","mon","tue","wed","thu","fri","sat"],months:["january","february","march","april","may","june","july","august","september","october","november","december"],shortMonths:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],sarcasmArray:["Not quite.","Huh?","Nope","Arg..","Sorry","What?","Bleck.","Nuh-uh.","Keep Trying.","No Entiendo."],dispFormat:"ddd MM-dd-yyyy h:mm tt",dtFormat:"MM-dd-yyyy h:mm tt",dateOnly:!1,displayDate:function(e){var t=this;return void 0!==e?(t.displayDiv.html(e),e):""!==t.value&&t.value?(t.displayDiv.html(t.minDate&&t.value<t.minDate?t.value.toString(t.dtFormat)+" is before the min date.":t.maxDate&&t.value>t.maxDate?t.maxDate.toString(t.dtFormat)+" is past the max date.":t.value.toString(t.dispFormat)),t.value.toString(t.dtFormat)):null},getM:function(e){for(var t=0;(e/=10)>=1;)t++;return t},init:function(){var e=this;Wui.Text.prototype.init.call(e),e.dateOnly&&(e.hasOwnProperty("dispFormat")||(e.dispFormat="ddd MM-dd-yyyy"),e.hasOwnProperty("dtFormat")||(e.dtFormat="MM-dd-yyyy")),e.append($("<div>").addClass("wui-date").append(e.setListeners(e),e.displayDiv=$("<div>").addClass("feedback").attr({tabindex:-1}),e.toggleCal=$("<button>").addClass("wui-cal-toggle").attr({tabIndex:-1}))),e.toggleCal.click(function(){return e.calendar?(e.calendar.remove(),e.calendar=void 0):($("body").append(e.calendar=e.makeCalendar(void 0,function(t,i,n){e.value=e.validDate(e.value)?new Date(t,i,n,e.value.getHours(),e.value.getMinutes()):new Date(t,i,n),e.val(e.displayDate())}).click(function(){return!1})),$(document).one("click",function(){$(".wui-cal").remove(),e.calendar=void 0}),Wui.positionItem(e.field,e.calendar)),!1})},num2Dec:function(e){var t={a:1,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20,thirty:30,forty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90,hundred:100,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18};e=e.toString().replace(/ and /g," ").replace(/-/g," "),$.each(t,function(i){e=e.replace(new RegExp("(^|[ ]|-)"+i+"(-|[ ]|$)","g")," "+t[i]+" ")});for(var i=$.trim(e).split(/[ ]+/),n=[],a=0,r=0;i[r];)this.getM(i[r])>2&&(n.push(i.splice(0,r+1)),r=0),r++;n.push(i);for(var l=0;l<n.length;l++){var o=this.txt2Num(n[l]);parseInt(o)&&(a+=parseInt(o))}return a},makeCalendar:function(e,t,i){function n(e){var l=1,u=0,d=0,c=e.getMonth(),h=e.getFullYear(),f=e.getDate(),p=new Date(h,c,1),g=p.getDay(),m=e.getDaysInMonth(),v=a.months[c],y='<table wui-month="'+c+'" wui-year="'+h+'">';for(y+='<tr><th colspan="7"><div class="wui-cal-header">'+v+"&nbsp;"+h+"</div></th></tr>",y+='<tr class="wui-cal-header-day">',u=0;6>=u;u++)y+="<td>"+a.shortDays[u].substring(0,2)+"</td>";for(y+="</tr><tr>",u=0;9>u;u++){for(d=0;6>=d;d++){if(y+="<td>",m>=l&&(u>0||d>=g)){var w=new Date(h,c,l),b=a.minDate&&w<a.minDate||a.maxDate&&w>a.maxDate?" wui-cal-disabled":"";y+='<a class="wui-cal-day'+b+'">'+l++ +"</a>"}y+="</td>"}if(l>m)break;y+="</tr><tr>"}y+="</tr></table>";var x=$(y),C=x.find(".wui-cal-header");return C.append('<a class="wui-cal-prev">','<a class="wui-cal-next">'),C.children("a").click(function(){var e=$(this).hasClass("wui-cal-prev")?-1:1,t=new Date(h,c+e,1);s.empty().append(n(t)),$(document).trigger($.Event("calupdate"+o),[a,s,t])}),i&&i.getMonth&&i.getMonth()==c&&i.getFullYear()==h&&x.find("a:contains("+f+"):first").addClass("wui-selected"),r.getMonth()==c&&r.getFullYear()==h&&x.find("a:contains("+r.getDate()+"):first").addClass("wui-highlight"),x.find("td a:not(.wui-cal-disabled)").click(function(){var e=$(this),i=parseInt(e.text()),n=e.parents("[wui-month]"),r=parseInt(n.attr("wui-month")),l=parseInt(n.attr("wui-year"));t(l,r,i),a.calendar.remove(),a.calendar=void 0}),x}i=a.validDate(i)?i:a.value;var a=this,r=new Date,l=e||(a.validDate(i)?i:r),o=a.name?"."+a.name:"",s=$("<div>").addClass("wui-cal");return s.append(n(l)),$(document).trigger($.Event("calupdate"+o),[a,s,l]),s},processDate:function(e){var t=this,i=e||t.field.val();if(i.length>0){var n=t.translateDate(i);return"Invalid Date"==n.toString()?void t.displayDate(t.sarcasmArray[Wui.randNum(0,t.sarcasmArray.length-1)]):(t.value=n,t.displayDate(),n)}t.value=null,t.displayDate("")},setListeners:function(e){return e.listnersSet!==!0?(e.listnersSet=!0,e.field.on("input",function(){e.processDate()}).on("keyup",function(t){if(40==t.keyCode||38==t.keyCode){var i=e.value instanceof Date?40==t.keyCode?1:-1:0,n=e.value instanceof Date?e.value:new Date;e.value=n.addDays(i),e.displayDate(),e.field.val(e.value.toString(e.dtFormat))}})):e.field},listnersSet:null,setMinDate:function(e){var t=this;return t.minDate=t.translateDate(e.toString()),t.field.datepicker("option","minDate",new Date(t.minDate.valueOf()+t.minute)),t.minDate},translateDate:function(e){var t=this,i=new Date,n=/\d{1,2}\/\d{1,2}\/\d{2,4}/,a=/([a|one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve|twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety|hundred|thousand|million|billion|trillion|and,\d,\s,-]+)\s((millisecond|second|minute|hour|day|week|month|year)+[s]*)\s(from|after|before|previous to)+\s(.+)$/,r=a.exec(e.toLowerCase());if(null!==r){var l=t.num2Dec(r[1]),o={from:1,after:1,before:-1,"previous to":-1},s=o[r[4]],u=t.translateDate(r[5]);return u["add"+r[3].charAt(0).toUpperCase()+r[3].slice(1)+"s"](l*s)}return null!==e.toLowerCase().match(/now/)?i:(e=e.toLowerCase().replace("noon","12").replace("midnight","00:00").replace(/o.clock/,"").replace(/(\d+)[st|nd|rd|th]+/,function(e,t){return t}).replace(/(\d{4})-(\d{1,2})-(\d{1,2})/g,function(e,t,i,n){return i+"/"+n+"/"+t}).replace(/(\d{1,2})-(\d{1,2})-(\d{2,4})/g,function(e,t,i,n){return t+"/"+i+"/"+n}).replace(/^(\d{1,2})-(\d{1,2})[\s]*/,function(e,t,i){return t+"/"+i+" "}).replace("at","@").replace(/(today|tomorrow|yesterday)/,function(e,n){var a={today:0,tomorrow:1,yesterday:-1},r=new Date(i.valueOf()+t.day*a[n]);return r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()}).replace(/(next|last) ([a-z]{3,10})[ ]*([0-9]+)*/,function(e,n,a,r){var l=t.day*("next"==n?1:-1),o=$.inArray(a,t.days)>-1?$.inArray(a,t.days):$.inArray(a,t.shortDays),s=$.inArray(a,t.months)>-1?$.inArray(a,t.months):$.inArray(a,t.shortMonths),u=o>-1?o:s>-1?s:-1,d=o>-1?"getDay":s>-1?"getMonth":"";if(u>-1){for(var c=i.valueOf(),h=new Date(c+=l);h[d]()!=u;)h=new Date(c+=l);return void 0!==s&&-1!=s&&0!==r.length&&h.setDate(parseInt(r)),h.getMonth()+1+"/"+h.getDate()+"/"+h.getFullYear()+" "}return""}).replace(/(\d{1,2})[ -]+([a-z]{3,10})([ -]*)/,function(e,i,n,a){return($.inArray(n,t.months)>-1?$.inArray(n,t.months):$.inArray(n,t.shortMonths))+1+"/"+i+a.replace("-"," ")}).replace(/(\b(one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve|twenty|thirty|forty|fifty|-)+\b)/g,function(e,i){return t.num2Dec(i)}).replace(/([a-z]{3,10}) (\d{1,2})[,]*/,function(e,i,n){return($.inArray(i,t.months)>-1?$.inArray(i,t.months):$.inArray(i,t.shortMonths))+1+"/"+n}).replace(/^(\d{1,2}\/\d{1,2}(?![\d]))([\s|\/]*)(\d{0,4})/,function(e,n,a,r){if(2==r.length){var l=parseInt(i.getFullYear().toString().substr(2,4)),o=100*parseInt(i.getFullYear().toString().substr(0,2)),s=parseInt(r),u=100-s,d=50>l?-100*(u>=50?0:1):100*(50>u?0:1),c=o+s+d;return n+"/"+c}if(4==r.length)return n+"/"+r;var h=n+"/"+i.getFullYear().toString(),f=new Date(h);return f.valueOf()>i.valueOf()?h:n+"/"+new Date(i.valueOf()+365*t.day).getFullYear()+" "}).replace(/(\d{1,2}\/\d{1,2})\s(\d{4})/,function(e,t,i){return t+"/"+i}),e=n.test(e)===!0?e:i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()+" "+e,e=e.replace(/(\d{1,2}\/\d{1,2}\/\d{4})\s(.+)/,function(e,t,i){return-1==i.indexOf("@")&&(i="@ "+i),t+" "+i}).replace(/\d[ ]*[a|p]$/,function(e){return e+"m"}).replace(/[a|p][.][m]*[.]*/,function(e){return e.replace(/[.]/g,"")}).replace(/\d.m/,function(e){return e.substring(0,e.length-2)+" "+e.substring(e.length-2,3)}).replace(/@ (\d+[ ]\d+)/,function(e,t){return t.replace(" ",":")}).replace(/@ (\d+)/,function(e,t,i,n){return-1!=n.indexOf(":")?e:e.trim()+":00 "}).replace(/@/g,""),new Date(e))},txt2Num:function(e){var t=0,i=0,n=0,a=0,r=0,l=!1;if(1==e.length)return e[0];for(;void 0!==e[t+1];)n=parseInt(e[t]),a=parseInt(e[t+1]),l=this.getM(n)<=this.getM(a),r=parseInt(e[e.length-1]),0===t?i=l?n*a:n+a:l?i*=a:i+=a,t++;return r!=a?this.getM(r)>2?i*=r:i+=r:i},getVal:function(){return this.value},setVal:function(e){null!==e?"string"==typeof e?(this.fieldText(e),this.processDate()):(this.value=e,this.fieldText(this.displayDate())):(this.fieldText(""),this.displayDiv.html(""),this.value=null)},validDate:function(e){return null===e||"undefined"==typeof e?!1:"function"!=typeof e.getTime?!1:"Invalid Date"==e.toString()?!1:!0}}),Wui.FileBasic=function(e){$.extend(this,{accept:null,multiple:!1,field:$("<input>").attr({type:"file"})},e),this.init()},Wui.FileBasic.prototype=$.extend(new Wui.Text,{disable:function(){this.disabled=!0,this.field.attr("disabled","true")},enable:function(){this.disabled=!1,this.field.removeAttr("disabled")},init:function(){var e=this;Wui.Text.prototype.init.call(e),e.append(e.field),e.multiple&&e.field.attr("multiple",!0),e.accept&&e.accept.length&&e.field.attr("accept",e.accept),e.field.change(function(){e.field.trigger($.Event("filechanged"),[e,e.field[0].files])})},validTest:function(e){return this.required?null!==e&&0!==e.length:!0},getVal:function(){return this.field[0].files},setVal:function(e){null===e&&this.field.val("")}}),Wui.File=function(e){$.extend(this,{beforeSubmit:function(){},fileTypeFilter:null,upFieldName:"fileupload",params:{},upSuccess:function(){},url:"",upTitleName:"title"},e,{field:$("<input>").attr({type:"text"})})},Wui.File.prototype=$.extend(new Wui.Text,{changeClick:function(){this.changeBtn.hide(),this.upBtn.show(),this.fileFrm.show(),this.field.removeClass().focus()},init:function(){var e=this;Wui.Text.prototype.init.call(e),e.append(e.wrapper=$("<div>").addClass("wui-file").append(e.field.off("blur"))),e.elAlias=e.wrapper;var t=Wui.id();e.push(e.iframe=new Wui.O({el:$("<iframe>").css({display:"none"}).attr({id:t,name:t})}),e.changeBtn=new Wui.Button({click:function(){e.fieldText(""),e.field.removeAttr("disabled"),e.changeClick()},text:"X",cls:"file-change field-btn"}),e.upBtn=new Wui.Button({text:"Browse",cls:"field-btn",click:function(){e.fileInput.click()}}),e.fileFrm=new Wui.O({el:$("<form>").attr({method:"post",enctype:"multipart/form-data",action:e.url,target:t})})),e.fileFrm.append(e.fileInput=$("<input>").attr({tabIndex:-1}).attr({name:e.upFieldName,type:"file"}).change(function(){e.submit(),e.field.focus()}))},submit:function(){var e=this;e.beforeSubmit(),e.params[e.upTitleName]=e.field.val(),null!==e.fileTypeFilter&&(e.params.file_type_filter=e.fileTypeFilter),e.field.addClass("has-file uploading").attr("disabled",!0).val("uploading..."),e.fileFrm.el.children("input[type!='file']").remove(),$.each(e.params,function(t,i){e.fileFrm.append($("<input>").attr({type:"hidden",name:t,value:i}))}),e.fileFrm.el.submit(),e.iframe.el.unbind().load(function(){e.onComplete($("body",e.iframe.el.contents()).text())})},devHook:function(){},onComplete:function(e){try{var t=this,i=$.parseJSON(e),n=Wui.unwrapData.call(t,i);t.devHook(n),t.field.removeClass("uploading empty"),i.success===!0?t.val(n.data,"upSuccess"):i.errors&&i.errors[0]&&i.errors[0].fileTypeError?(Wui.errRpt(i.errors[0].fileTypeError,"Invalid File Type"),t.field.removeClass("has-file uploading").removeAttr("disabled"),t.fieldText("")):t.upFailure(i)}catch(a){console.log("Upload Error",a,e),t.upFailure(a,e)}},upFailure:function(e,t){console.log("Upload Failure",e,t),this.fieldText("Upload Failure")},getVal:function(){return this.value||{}},setVal:function(e){return this.value=this.value||{},$.extend(this.value,e),e},val:function(e,t){var i=Wui.FormField.prototype.val.apply(this,arguments);return this[t]&&"function"==typeof this[t]&&this[t](),i},valChange:function(){var e=this;e.value?(e.field.addClass("has-file").removeAttr("disabled"),e.upBtn.hide(),e.fileFrm.hide(),e.changeBtn.show(),e.field.addClass("has-file "+(void 0!==e.value.extension?"icon-"+e.value.extension.replace(".",""):"")).attr("disabled",!0),e.fieldText(e.value[e.upTitleName])):(e.field.removeClass(),e.upBtn.show(),e.fileFrm.show(),e.changeBtn.hide(),e.field.val(null))}}),Wui.input=function(e,t,i,n,a){n?n.length||(n=n instanceof Wui.FormField||n.ftype?[n]:[{ftype:"Wui.Text"}]):n=[{ftype:"Wui.Text"}],1==n.length&&$.extend(n[0],{label:e,required:!0,name:"inputField"}),void 0!==a&&n.splice(0,0,{ftype:"Wui.Note",html:a});var r=new Wui.Form({labelPosition:"left",items:n}),l=new Wui.Window({title:i||"Input",bbar:[new Wui.Button({text:"Cancel",click:function(){l.closeOkay=!0,l.close()}}),new Wui.Button({text:"Submit",click:function(){l.getVal()}})],isModal:!0,items:[r],cls:"wui-input-window",width:600,getVal:function(){var e=r.getData();if(e)if(t&&"function"==typeof t){var i=Wui.getKeys(e).length,n=t(1==i&&e.inputField?e.inputField:e);l.closeOkay=void 0===t?!0:n}else l.closeOkay=!0},doClose:function(){l.closeOkay=!0,l.close()},onWinClose:function(){return l.closeOkay!==!0?!1:l.closeOkay}});return l.header.splice(0,1),r}}(jQuery,Wui),function(e,t,i){i.stateMachine=function(t){e.extend(this,{changeMethod:function(){}},t)},i.stateMachine.prototype={setState:function(e){var i=t.location.href.split("#"),n=i[0]+"#",a=n;return e&&"object"==typeof e?a=n+this.stringify(e):e&&"string"==typeof e&&(a=n+e),t.location=a},stringify:function(e){var t="";for(var n in e){var a=i.getKeys(e[n].params);t+=(n>0?"/":"")+e[n].view;for(var r=0;r<a.length;r++)t+=(r>0?"&":"?")+a[r]+"="+e[n].params[a[r]]}return t},getState:function(){var e=[];return t.location.hash.replace(/([^\/^#]+)/g,function(t){var i={};t=t.replace(/(\?|\&)([^=]+)\=([^&]*)/g,function(e,t,n,a){return i[n]=a,""}),e.push({view:t,params:i})}),e},getParam:function(e,t){var i=this.getState(),n=void 0;for(var a in i)if(i[a].view===e&&i[a].params[t])return i[a].params[t];return n},setParam:function(t,i,n){var a=this.getState();for(var r in a)if(a[r].view===t)return"string"==typeof i?a[r].params[i]=n:e.extend(a[r].params,i),this.setState(a),n;return void 0},changeView:function(e,t){var i=this.getState();for(var n in i)i[n].view===e&&(i[n].view=t);this.setState(i)},setView:function(e,t){var i=[{view:e}];t&&(i[0].params=t),this.setState(i)},addView:function(e,t){var i=this.getState(),t=t||{};for(var n in i)if(i[n].view===e)return i[n].params=t,this.setState(i),e;return i.push({view:e,params:t}),this.setState(i),e},clearView:function(e){var t=this.getState(),i=null;for(var n in t)if(t[n].view===e){i=t.splice(n,1);break}return this.setState(t),i},getViews:function(){for(var e=this.getState(),t=[],i=0;i<e.length;i++)t.push(e[i].view);return t},clearState:function(){this.setState()},addChangeMethod:function(i){var n=this,a=n.getState(),r=n.changeMethod;n.changeMethod=function(e){r(e),i(e)},e(t).off("hashchange").on("hashchange",function(){n.changeMethod.call(n,a)})},turnOff:function(){this.changeMethod=function(){},e(t).off("hashchange")}}}(jQuery,this,Wui),function(e,t,i){"$:nomunge";function n(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var a,r="hashchange",l=document,o=e.event.special,s=l.documentMode,u="on"+r in t&&(s===i||s>7);e.fn[r]=function(e){return e?this.bind(r,e):this.trigger(r)},e.fn[r].delay=50,o[r]=e.extend(o[r],{setup:function(){return u?!1:void e(a.start)},teardown:function(){return u?!1:void e(a.stop)}}),a=function(){function a(){var i=n(),o=c(s);i!==s?(d(s=i,o),e(t).trigger(r)):o!==s&&(location.href=location.href.replace(/#.*/,"")+o),l=setTimeout(a,e.fn[r].delay)}var l,o={},s=n(),u=function(e){return e},d=u,c=u;return o.start=function(){l||a()},o.stop=function(){l&&clearTimeout(l),l=i},o}()}(jQuery,this);