/*! Wui 1.1
 * Copyright (c) 2013 Stephen Rolfe Nielsen - Utah State University Research Foundation 
 *
 * @license MIT
 * https://static4.usurf.usu.edu/resources/wui-nextgen/wui-1-1/license.html
 */

 (function(){var e;var t=function(){};var n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];var r=n.length;var i=window.console=window.console||{};while(r--){e=n[r];if(!i[e]){i[e]=t}}})();var Wui=Wui||{};(function(e,t){e.ajaxSetup({cache:false,error:function(t){console.log(t);var n=null;try{n=e.parseJSON(t.responseText)}catch(r){n={fatalError:"Aw Snap! There was a problem talking to the server."}}if(n!==null)Wui.errRpt(n.fatalError)}});Wui.id=function(){if(Wui.idCounter===undefined)Wui.idCounter=0;return"wui-"+Wui.idCounter++};Wui.getKeys=function(t){var n=[];if(t)e.each(t,function(e){n.push(e)});return n.sort()};Wui.scrollbarWidth=function(){var t,n,r;if(r===undefined){t=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body");n=t.children();r=n.innerWidth()-n.height(99).innerWidth();t.remove()}return r};Wui.randNum=function(e,t){t=t-e+1;return e+Math.floor(Math.random()*t)};Wui.maxZ=function(){var t=Math.max.apply(null,e.map(e('body > *, [style*="z-index"]'),function(t){if(e(t).css("position")!="static")return parseInt(e(t).css("z-index"))||0}));return(e.isNumeric(t)?t:0)+1};Wui.unwrapData=function(e){var t=this,n={},r=t.hasOwnProperty("dataContainer")?t.dataContainer:Wui.Data.prototype.dataContainer,i=t.hasOwnProperty("totalContainer")?t.totalContainer:Wui.Data.prototype.totalContainer,s=r&&e[r]?e[r]:e,o=i&&e[i]?e[i]:s.length;n.data=s;n.total=o;return n};Wui.fit=function(n,r,i){if(n instanceof Array&&n.length>0){var s=0,o=["height","width"],u=n[0].parent?n[0].parent:n[0].el.parent(),a=u.el?u.elAlias||u.el:u;r=r&&r.toLowerCase?r.toLowerCase():r;r=e.inArray(r,o)>=0?r:o[0];var f=o[e.inArray(r,o)?0:1];if(i!==true)for(s=0;s<n.length;s++)if(i=n[s].el["outer"+f.charAt(0).toUpperCase()+f.slice(1)]()>a[f]())break;var l=i===true?Wui.scrollbarWidth():0;parentSize=(e(a)[0]===e("body")?e(t):e(a))[r]()-l,fitCt=0,fixedSize=0,fitMux=0;e.each(n,function(t,n){if(n.fit){fitCt+=n.fit;n[r]=-1}else if(n[r]){if(e.isNumeric(n[r])){fixedSize+=n[r]}else{var i=Math.floor(parseFloat(n[r])/100*parentSize);fixedSize+=n[r]=i}delete n.fit}else{fitCt+=n.fit=1}});if(fitCt===0&&fixedSize!=parentSize){fitCt=1;e.each(n,function(e,t){t.fit=t[r]/fixedSize;t[r]=-1})}fitMux=fitCt!==0?(parentSize-fixedSize)/fitCt:0;e.each(n,function(t,n){var i={};if(n.fit){i[r]=Math.floor(fitMux*n.fit);e(n.el).css(i)}})}else{console.log("Improper collection specified",arguments)}};Wui.O=function(t){e.extend(this,{hidden:false},t)};Wui.O.prototype={addToDOM:function(t,n,r){var i=t.appendTo!==undefined?t.appendTo:t.prependTo!==undefined?t.prependTo:n!==undefined&&n!==null?n:t.parent!==undefined&&t.parent.elAlias!==undefined?t.parent.elAlias:t.parent!==undefined&&t.parent.el!==undefined?t.parent.el:e("body"),s=t.appendTo!==undefined?"append":t.prependTo!==undefined?"prepend":r!==undefined&&i[r]?r:"append";try{e(i)[s](t.el)}catch(o){try{e(i)[s](t)}catch(o){}}this.cssByParam(t);return true},append:function(t){var n=this,r=n.elAlias||n.el;e.each(arguments,function(e,t){r.append(t)})},clear:function(){var e=this,t=e.elAlias||e.el;t.children().remove()},callRender:function(){var e=this;e.cssByParam(e);if(e.onRender)e.onRender();var t=false;e.each(function(e){if(e.fit){t=true;return false}});if(e.fitDimension||t)Wui.fit(e.items,e.fitDimension||undefined);e.each(function(e){if(e.callRender)e.callRender()});if(e.afterRender)e.afterRender()},applyAttr:function(t,n){var r=n!==undefined&&(typeof n==="string"||typeof n==="number");if(r)e(this.el).attr(t,n);return r},cssByParam:function(n){n=n||this;if(n.el&&n.el.addClass){if(n.applyAttr){n.applyAttr("id",n.id);n.applyAttr("name",n.name);n.applyAttr("tabindex",n.tabIndex)}try{if(n.attr&&typeof n.attr=="object")n.el.attr(n.attr)}catch(r){}if(e.isNumeric(n.height)&&n.height>=0)n.el.css({height:n.height});if(e.isNumeric(n.width)&&n.width>=0)n.el.css({width:n.width});if(n.width&&n.width.indexOf&&n.width.indexOf("%")!=-1)n.el.css({width:Math.floor(parseFloat(n.width)/100*(e(n.el.parent())[0]==e("body")[0]?e(t):n.el.parent()).width())});if(n.height&&n.height.indexOf&&n.height.indexOf("%")!=-1){n.el.css({height:Math.floor(parseFloat(n.height)/100*(e(n.el.parent())[0]==e("body")[0]?e(t):n.el.parent()).height())})}if(n.hidden)n.el.css("display","none");return n.el.addClass(n.cls)}else{return n}},each:function(e,t){t=t===undefined?true:t;var n=t?0:this.items.length;if(t){for(n;n<this.items.length;n++){if(e(this.items[n],n)===false)break}}else{for(n;n>=0;n--){if(e(this.items[n],n)===false)break}}return true},hide:function(){var t=["fadeOut"];e.each(arguments,function(e,n){t.push(n)});this.hidden=true;return this.showHide.apply(this,t)},layout:function(){var e=this;e.cssByParam(e);var t=false;e.each(function(e){if(e.fit){t=true;return false}});if(e.fitDimension||t)Wui.fit(e.items,e.fitDimension||undefined);e.each(function(e){if(e.layout)e.layout()})},place:function(e){var t=this;if(t.items===undefined)t.items=[];t.each(function(e){e.parent=t;if(e.place)e.place();else t.addToDOM(e)});t.addToDOM(t);if(e&&typeof e=="function")e(t);if(t.parent===undefined)t.callRender();return t},push:function(){var t=this;if(t.items===undefined)t.items=[];e.each(arguments,function(e,n){n.parent=t;if(n.place)n.place();else t.addToDOM(n);if(n.onRender)n.onRender();if(n.layout)n.layout()});return Array.prototype.push.apply(t.items,arguments)},remove:function(){var e=this,t=null;if(e.parent){e.parent.each(function(n,r){if(n===e)t=r},false);if(t!==null)e.parent.splice(t,1)}this.el.remove();delete this},show:function(){var t=["fadeIn"];e.each(arguments,function(e,n){t.push(n)});this.hidden=false;return this.showHide.apply(this,t)},showHide:function(e,t,n){t=typeof t=="number"?t:1;if(typeof arguments[1]=="function")n=arguments[0];return this.el[e](t,n)},splice:function(e,t){var n=this,r=n.elAlias||n.el;e=parseInt(e);if(n.items===undefined)n.items=[];for(var i=e;i<e+t;i++)if(n.items[i]&&n.items[i].el)n.items[i].el.remove();var s=Array.prototype.splice.apply(n.items,arguments),o=arguments.length-2;if(n.items.length==o){for(i=0;i<n.items.length;i++){n.addToDOM(n.items[i],r);n.items[i].parent=n}}else if(n.items[e+o]===undefined){for(i=e;i<n.items.length;i++){n.addToDOM(n.items[i],n.items[i-1].el,"after");n.items[i].parent=n}}else if(o!==0){for(i=e+o;i>0;i--){n.addToDOM(n.items[i-1],n.items[i].el,"before");n.items[i-1].parent=n}}return s}};Wui.Data=function(t){e.extend(this,{data:[],identifier:null,name:null,params:{},url:null,waiting:false,ajaxConfig:{},total:0},t)};Wui.Data.prototype={dataContainer:null,totalContainer:null,ajaxWait:10,dataChanged:function(){},dataEach:function(e){for(var t=0;t<this.data.length;t++)if(e(this.data[t],t)===false)break;return true},loadData:function(){var t=this,n=e.extend({data:t.params,dataType:"json",success:function(e){t.success.call(t,e)},error:function(e){t.failure.call(t,e)}},t.ajaxConfig);if(!t.waiting){t.waiting=true;t.setParams.apply(t,arguments);t.beforeLoad.apply(t,arguments);e.ajax(t.url,n)}else{setTimeout(function(){t.loadData.apply(t,arguments)},t.ajaxWait)}},setParams:function(t){if(t&&typeof t==="object")e.extend(this.params,t)},setData:function(n,r){var i=this;i.beforeSet(n);i.data=i.processData(n);i.total=r!==undefined?r:i.data.length;i.dataChanged(i.data);e(t).trigger(e.Event("datachanged"),[i.name||"wui-data",i]);i.afterSet(i.data)},beforeLoad:function(){},afterSet:function(){},beforeSet:function(){},success:function(e){var t=this,n=Wui.unwrapData.call(t,e);t.waiting=false;t.onSuccess(e);t.setData(n.data,n.total)},onSuccess:function(){},onFailure:function(){},failure:function(e){this.waiting=false;this.onFailure(e)},processData:function(e){return e}};Wui.Template=function(t){e.extend(this,t)};Wui.Template.prototype={template:null,data:null,make:function(t){var n=this;if(n.data&&n.template){var r=n.template;if(e.isNumeric(t))e.extend(n.data,{wuiIndex:t});return e(r.replace(/\{(\w*)\}/g,function(e,t){return n.data[t]!==undefined?n.data[t]:""}).replace(/\{\((.*?)\)\}/g,function(e,t){var r=Wui.getKeys(n.data),i=[];for(var s=0;s<r.length;s++)i.push(n.data[r[s]]);r.push("return "+t);var o=Function.apply(null,r);return o.apply(null,i)}))}throw new Error("Template engine missing data and/or template.")}};Wui.DataList=function(t){e.extend(this,{afterMake:function(){},autoLoad:true,el:e("<div>"),displayMax:-1,init:function(){},multiSelect:false,selected:[]},t);this.init()};Wui.DataList.prototype=e.extend(new Wui.O,new Wui.Template,new Wui.Data,{dataChanged:function(){this.make()},clearSelect:function(){var t=this;t.el.find(".wui-selected").removeClass("wui-selected");t.selected=[];t.el.trigger(e.Event("wuichange"),[t,t.el,t.selected])},itemSelect:function(t,n){var r=this;r.el.find(".wui-selected").removeClass("wui-selected");t.el.addClass("wui-selected");r.selected=[t];if(!r.multiSelect&&!n)r.el.trigger(e.Event("wuiselect"),[r,t.el,t.rec]);return t},itemDeselect:function(t){var n=this;t.el.removeClass("wui-selected");n.selected=[];n.el.trigger(e.Event("deselect"),[n,t.el,t.rec]);return t},createItem:function(t){var n=this;t.el.click(function(r){var i=n.selected.length;if(!n.multiSelect||!(r.metaKey||r.ctrlKey)){if(i>0&&n.selected[0]===t){n.itemDeselect(t)}else{n.itemSelect(t)}}else{var s=e(this).hasClass("wui-selected");e(this).toggleClass("wui-selected",!s);if(s)e.each(n.selected||[],function(e,r){if(r==t)n.selected.splice(e,1)});else n.selected.push(t)}n.el.trigger(e.Event("wuichange"),[n,t.el,t.rec,n.selected])}).dblclick(function(r){n.itemSelect(t,true);n.el.trigger(e.Event("wuidblclick"),[n,t.el,t.rec]).trigger(e.Event("wuichange"),[n,t.el,t.rec,n.selected]);return false});return n.modifyItem(t)},modifyItem:function(e){return e.el},make:function(){var t=this,n=t.data||[],r=e("<div>");t.items=[];for(var i=0;t.displayMax<0&&i<n.length||t.displayMax>0&&i<t.displayMax&&i<n.length;i++){var s=t.data=n[i],o={el:Wui.Template.prototype.make.call(t,i),rec:s};Array.prototype.push.call(t.items,o);r.append(t.createItem(o))}t.clear();t.append(r.children().unwrap());t.data=n;t.autoLoad=true;t.afterMake();t.el.trigger(e.Event("refresh"),[t,t.data]);t.resetSelect()},onRender:function(){if(this.autoLoad){if(this.url===null)this.make();else this.loadData()}},refresh:function(){this.onRender()},resetSelect:function(){var t=this,n=t.selected;t.selected=[];e.each(n||[],function(e,n){t.each(function(e){var r=t.identifier?e.rec[t.identifier]===n.rec[t.identifier]:JSON.stringify(e.rec)===JSON.stringify(n.rec);if(r){if(t.multiSelect){e.el.addClass("wui-selected");t.selected.push(e,true)}else{t.itemSelect(e)}}})});t.scrollToCurrent()},scrollToCurrent:function(){var t=this,n=t.el.find(".wui-selected:first"),r=n.offsetParent(),i=function(){var t=0;n.prevAll().each(function(){t+=e(this).outerHeight()-.55});return t}();r.animate({scrollTop:i},500)},selectBy:function(e,t){var n=this,r=undefined;n.each(function(i){if(i.rec[e]&&i.rec[e]==t)return r=n.itemSelect(i)});n.scrollToCurrent();return r}});Wui.Button=function(t){e.extend(this,{el:e("<button>").attr({unselectable:"on"}),disabled:false,toolTip:null,tabIndex:0,text:"Button"},t);this.init()};Wui.Button.prototype=e.extend(new Wui.O,{click:function(){},init:function(){function n(n){if(!t.disabled){t.click(arguments);t.el.trigger(e.Event("wuibtnclick"),[t])}return false}var t=this;t.el.addClass("wui-btn").click(n).keyup(function(e){if(e.keyCode==13||e.keyCode==32)n(e)}).html(t.text).attr({title:t.toolTip,tabindex:t.tabIndex});if(t.disabled)t.disable()},disable:function(){this.disabled=true;this.el.toggleClass("disabled",this.disabled).attr("disabled",true).removeAttr("tabindex")},enable:function(){this.disabled=false;this.el.toggleClass("disabled",this.disabled).removeAttr("disabled").attr({tabindex:this.tabIndex})},setText:function(e){return this.el.html(e)}});Wui.Pane=function(t){e.extend(this,{bbar:[],border:true,borderStyle:{borderWidth:6},tbar:[],disabled:false,titleAlign:"left",height:"100%",maskHTML:"Empty",title:null},t);this.init()};Wui.Pane.prototype=e.extend(new Wui.O,{disable:function(){this.disabled=true;this.addMask();this.footer.each(function(e){if(e.disable)e.disable()});this.header.each(function(e){if(e.disable)e.disable()})},enable:function(){var e=this;e.disabled=false;e.removeMask();e.footer.each(function(e){if(e.enable)e.enable()});e.header.each(function(e){if(e.enable)e.enable()})},addMask:function(){this.mask=this.container.clone().html(this.maskHTML).addClass("wui-mask").appendTo(this.container.parent())},removeMask:function(){var e=this,t=e.mask||e.el.find(".wui-mask");if(t){t.fadeOut(500,function(){t.remove();e.mask=undefined})}},setMaskHTML:function(e){this.maskHTML=e;if(this.mask)this.mask.html(e)},init:function(t){var n=t||this;n.el=e("<div>").addClass("wui-pane").append(e("<div>").addClass("wui-pane-wrap").append(n.container=e("<div>").addClass("wui-pane-content")));n.sureEl=n.el;n.header=new Wui.O({el:e('<div><h1></h1><div class="wui-h-cntnt"></div></div>'),cls:"wui-pane-header wui-pane-bar",items:n.tbar,parent:n,appendTo:n.el});n.header.elAlias=n.header.el.children(".wui-h-cntnt");n.header.title=n.header.el.children("h1");n.footer=new Wui.O({el:e("<div>"),cls:"wui-pane-footer wui-pane-bar",items:n.bbar,parent:n,appendTo:n.el});n.elAlias=n.container;if(n.border)n.el.css(n.borderStyle);if(n.tbar.length!==0||n.title!==null){n.placeHeader();n.setTitle(n.title)}if(n.bbar.length!==0)n.placeFooter()},placeFooter:function(){this.sureEl.css({borderBottomWidth:0});this.sureEl.children(".wui-pane-wrap").css({paddingBottom:"40px"});this.footer.place();this.footer.callRender()},placeHeader:function(){this.sureEl.css({borderTopWidth:0});this.sureEl.children(".wui-pane-wrap").css({paddingTop:"40px"});this.setTitleAlign();this.header.place();this.header.callRender()},setTitle:function(e){if(e)this.header.title.text(this.title=e);return e},setTitleAlign:function(e){var t=this;t.titleAlign=e||t.titleAlign;t.header.title.addClass(t.titleAlign);var n=t.titleAlign==="right"?"left":"right";t.header.elAlias.css("text-align",n)},afterRender:function(){function t(){if(!e.parent)e.layout()}var e=this;document.addEventListener("animationstart",t,false);document.addEventListener("MSAnimationStart",t,false);document.addEventListener("webkitAnimationStart",t,false);if(e.disabled){e.disable()}else if(this.footer.items.length){this.footer.items[this.footer.items.length-1].el.focus()}}});Wui.Window=function(t){e.extend(this,{bbar:[],border:false,height:400,isModal:false,onWinClose:function(){},onWinOpen:function(){},tbar:[],title:"Window",maskHTML:'Loading <span class="wui-spinner"></span>',width:600},t);this.init()};Wui.Window.prototype=e.extend(new Wui.Pane,{close:function(){var t=this;if(t.onWinClose(t)!==false){t.windowEl.trigger(e.Event("close"),[t]);t.remove()}},disable:function(){Wui.Pane.prototype.disable.call(this);this.closeBtn.enable()},init:function(){function n(e){if(parseInt(t.el.css("z-index")||1)<=Wui.maxZ()){t.el.css("z-index",Wui.maxZ()+1)}}var t=this;t.appendTo=e("body");if(t.isModal){t.modalEl=e("<div>").addClass("wui-overlay");e("body").append(t.appendTo=t.modalEl.css("z-index",Wui.maxZ()+1))}t.tbar.push(t.closeBtn=new Wui.Button({click:function(){t.close()},text:"X"}));if(t.bbar.length===0)t.bbar=[new Wui.Button({click:function(){t.close()},text:"Close"})];Wui.Pane.prototype.init(t);t.windowEl=t.el.draggable({handle:t.header.el,start:n}).addClass("wui-window").resizable({minWidth:t.width,minHeight:t.height,resize:function(){t.container.trigger(e.Event("resize"),[t.container.width(),t.container.height()])}}).css("z-index",Wui.maxZ()+1).click(n);t.place();t.resize();if(t.isModal)t.el=t.modalEl;this.onWinOpen(t);t.windowEl.trigger(e.Event("open"),[t])},resize:function(t,n){var r=this,i=r.container[0].scrollHeight+r.header.el.outerHeight()*2;if(arguments.length!==0)r.windowEl.height(r.height=n).width(r.width=t);else r.windowEl.height(i>=e.viewportH()?e.viewportH()-10:i);r.windowEl.css({top:Math.floor(e.viewportH()/2-r.windowEl.height()/2)+"px",left:!r.isModal?Math.floor(e.viewportW()/2-r.windowEl.width()/2)+"px":"",position:!r.isModal?"absolute":""});r.container.trigger(e.Event("resize"),[r.container.width(),r.container.height()]);r.layout()}});Wui.msg=function(t,n,r,i){var s=i!==undefined?[new Wui.O({el:e("<p>").html(t)}),i]:[new Wui.O({el:e("<p>").html(t)})],o=new Wui.Window({title:n||"Message",isModal:true,items:s,width:350,height:200,onWinClose:r||function(){}});return o};Wui.errRpt=function(t,n,r,i){var s=Wui.msg(t,n,i);if(e.isArray(r))s.footer.push.apply(s.footer,r);s.container.find("p").addClass("err");return s};Wui.confirm=function(e,t,n,r){var i=Wui.msg.apply(this,arguments);i.doAnswer=function(e){if(n&&typeof n=="function")n(e);i.answerRun=true;i.close()};i.onWinClose=function(){return i.answerRun!==true?false:i.answerRun};i.footer.splice(0,1,new Wui.Button({text:"No",click:function(){i.doAnswer(false)}}),new Wui.Button({text:"Yes",click:function(){i.doAnswer(true)}}));i.header.splice(0,1);return i}})(jQuery,this);(function(e,t,n){n.stateMachine=function(t){e.extend(this,{changeMethod:function(){}},t)};n.stateMachine.prototype={setState:function(e){var n=t.location.href.split("#"),r=n[0]+"#",i=r;if(e&&typeof e==="object"){i=r+this.stringify(e)}else if(e&&typeof e==="string"){i=r+e}return t.location=i},stringify:function(e){var t="";for(var r in e){var i=n.getKeys(e[r].params);t+=(r>0?"/":"")+e[r].view;for(var s=0;s<i.length;s++)t+=(s>0?"&":"?")+i[s]+"="+e[r].params[i[s]]}return t},getState:function(){var e=[];t.location.hash.replace(/([^\/^#]+)/g,function(t){var n={};t=t.replace(/(\?|\&)([^=]+)\=([^&]+)/g,function(e,t,r,i){n[r]=i;return""});e.push({view:t,params:n})});return e},getParam:function(e,t){var n=this.getState(),r=undefined;for(var i in n)if(n[i].view===e&&n[i].params[t])return n[i].params[t];return r},setParam:function(e,t,n){var r=this.getState();for(var i in r){if(r[i].view===e&&r[i].params[t]){r[i].params[t]=n;this.setState(r);return n}}return undefined},changeView:function(e,t){var n=this.getState();for(var r in n)if(n[r].view===e)n[r].view=t;this.setState(n)},setView:function(e,t){var n=[{view:e}];if(t)n[0].params=t;this.setState(n)},getViews:function(){var e=this.getState(),t=[];for(var n=0;n<e.length;n++)t.push(e[n].view);return t},clearState:function(){this.setState()},addChangeMethod:function(n){var r=this,i=r.getState(),s=r.changeMethod;r.changeMethod=function(e){s(e);n(e)};e(t).off("hashchange").on("hashchange",function(){r.changeMethod.call(r,i)})},turnOff:function(){this.changeMethod=function(){};e(t).off("hashchange")}}})(jQuery,this,Wui);(function(e,t,n){"$:nomunge";function f(e){e=e||location.href;return"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var r="hashchange",i=document,s,o=e.event.special,u=i.documentMode,a="on"+r in t&&(u===n||u>7);e.fn[r]=function(e){return e?this.bind(r,e):this.trigger(r)};e.fn[r].delay=50;o[r]=e.extend(o[r],{setup:function(){if(a){return false}e(s.start)},teardown:function(){if(a){return false}e(s.stop)}});s=function(){function c(){var n=f(),i=l(o);if(n!==o){a(o=n,i);e(t).trigger(r)}else if(i!==o){location.href=location.href.replace(/#.*/,"")+i}s=setTimeout(c,e.fn[r].delay)}var i={},s,o=f(),u=function(e){return e},a=u,l=u;i.start=function(){s||c()};i.stop=function(){s&&clearTimeout(s);s=n};return i}()})(jQuery,this);(function(e,t){e.fn.overrideNodeMethod=function(t,n){var r=e.fn[t];var i=this;e.fn[t]=function(){if(this[0]==i[0]){return n.apply(this,arguments)}else{return r.apply(this,arguments)}}};t.Form=function(t){e.extend(this,{disabled:false,labelPosition:"top"},t,{formChanged:false,el:e("<div>").addClass("wui-form"),errors:[]});this.init()};t.Form.prototype=e.extend(new t.O,{clearData:function(){this.setData()},dispErrors:function(){var e="";for(var n=0;n<this.errors.length;n++)e+=this.errors[n]+"<br/>";t.errRpt(e,"Form Errors")},each:function(e){return t.O.prototype.each.call(this,function(n,r){if(!(n instanceof t.Note))return e(n,r)})},errCls:"wui-form-err",getData:function(){if(this.validate()){return this.getRawData()}else{this.dispErrors();return false}},getField:function(e){var t=null;this.each(function(n){if(n.name==e)t=n.val()});return t},getFrmItm:function(e){var t=undefined;this.each(function(n,r){if(n.name==e)t=n});return t},getRawData:function(){var e={};this.each(function(t){e[t.name]=t.val()});return e},init:function(){},normFrmItem:function(n){var r=this;if(!(n.disabled&&n.disabled===true))e.extend(n,{disabled:r.disabled});if(n.ftype&&!(n instanceof t.FormField)){if(!n.labelPosition)e.extend(n,{labelPosition:r.labelPosition});var i=n.ftype.split(".");if(window[i[0]]&&window[i[0]][i[1]])return new window[i[0]][i[1]](n);else throw"Object type "+n.ftype+" is not defined."}else if(n instanceof t.FormField){if(!n.hasOwnProperty("labelPosition")&&n.lbl)n.lbl.setLabelPosition(r.labelPosition);return n}else{return n}},place:function(){var e=this;if(e.items===undefined)e.items=[];e.each(function(t,n){e.items[n]=e.normFrmItem(t)});return t.O.prototype.place.apply(this,arguments)},push:function(){var n=this,r=[];e.each(arguments,function(e,t){r.push(n.normFrmItem(t))});return t.O.prototype.push.apply(this,r)},remFrmItm:function(e){var n=this;this.each(function(r,i){if(r.name==e)t.O.prototype.splice.call(n,i,1)});return true},formChange:function(t,n){if(t)this.el.trigger(e.Event("formupdate"),[this,n]);this.formChanged=t;return this.formChanged},setData:function(e,t){if(e){this.setData();this.each(function(n){if(e[n.name])n.val(e[n.name],t)})}else{this.each(function(e){e.val(null,t)})}this.formChange(false)},disable:function(){return this.each(function(e){e.disable()})},enable:function(){return this.each(function(e){e.enable()})},setField:function(e,t){this.each(function(n){if(n.name==e)n.val(t)})},throwError:function(e){this.errors.push(e);return false},validate:function(){var e=this;e.errors=[];e.each(function(t){if(t.el&&t.el.toggleClass){t.el.toggleClass(e.errCls,!t.validate())}});this.formChange(false);return e.errors.length===0}});t.Note=function(t){e.extend(this,{html:"",align:null},t);this.init()};t.Note.prototype=e.extend(new t.O,{init:function(){this.el=e("<p>").html(this.html).addClass("wui-note "+this.align?this.align:"")}});t.Label=function(t){e.extend(this,{html:"",labelPosition:"top"},t);this.init()};t.Label.prototype=e.extend(new t.O,{init:function(){var t=this;t.el=e("<div>").addClass("wui-lbl").append(t.label=e("<label>").addClass(t.cls).attr(t.attr?t.attr:{}));t.setLabel(t.html);t.setLabelPosition(t.labelPosition)},setLabel:function(e){this.label.html(this.html=e);return this.label.html()},setLabelPosition:function(t){var n=this;t=t.toLowerCase();if(e.inArray(t,["top","left","bottom","right"])>=0){n.el.removeClass("lbl-"+n.labelPosition).addClass("lbl-"+t);if(n.field)n.field.labelPosition=t;return n.labelPosition=t}return false}});t.FormField=function(t){e.extend(this,{disabled:false,invalidMsg:null,label:null,labelPosition:"top",labelCls:null,required:false,validRegEx:null,validTest:null},t)};t.FormField.prototype=e.extend(new t.O,{init:function(){var n=this;n.value=n.hasOwnProperty("value")?n.value:null;n.el=e("<div>").addClass("wui-fe");if(n.label&&n.label.length>0){n.lbl=new t.Label({html:n.label,cls:n.labelCls,field:n,labelPosition:n.labelPosition});n.elAlias=n.el;n.el=n.lbl.el.append(n.elAlias)}return n.el},onRender:function(){if(this.disabled)this.disable();if(this.hasOwnProperty("value"))this.val(this.value,false)},disable:function(){this.disabled=true;if(this.el&&this.el.addClass)this.el.addClass("wui-disabled").find("input,textarea,iframe").attr("disabled","disabled")},enable:function(){this.disabled=false;if(this.el&&this.el.addClass)this.el.removeClass("wui-disabled").find(".wui-disabled,*[disabled=disabled]").removeAttr("disabled")},validate:function(){function r(){return t.parent&&t.parent.throwError?t.parent.throwError(n):false}var t=this,n=t.invalidMsg!==null?t.invalidMsg:t.label!==null?"A value for '"+t.label+"' is required.":t.name!==undefined?"A value for '"+t.name+"' is required.":"A required field has an improper value.";if(t.validTest&&typeof t.validTest=="function")if(t.validTest(t.val())===false)return r();if(t.validRegEx!==null)if(!t.validRegEx.test(e.trim(t.val())))return r();if(t.required&&e.trim(t.val()).length===0)return r();return true},val:function(){if(!arguments.length){return this.getVal()}else{var e=this.value;this.setVal.apply(this,arguments);if(arguments[1]!==false)this.setChanged(e);return arguments}},setChanged:function(n){if(this.parent&&this.parent instanceof t.Form)this.parent.formChange(true,this);this.valChange(this);if(this.el){this.el.trigger(e.Event("valchange"),[this,this.value,n])}else{if(this.parent&&this.parent instanceof t.Form)this.parent.el.trigger(e.Event("hiddenchange"),[this,this.value,n])}},getVal:function(){return this.value},setVal:function(e){this.value=e},valChange:function(e){}});t.Hidden=function(t){e.extend(this,{el:null},t);this.init()};t.Hidden.prototype=e.extend(new t.FormField,{init:function(){}});t.Text=function(t){e.extend(this,{blankCls:"empty",blankText:""},t,{field:e("<input>").attr({type:"text"})});this.init()};t.Text.prototype=e.extend(new t.FormField,{init:function(){var e=this;t.FormField.prototype.init.call(e);if(e.blankText&&e.blankText.length)e.setBlankText(e.blankText);e.append(t.Text.prototype.setListeners.call(e,e))},setBlankText:function(t){var n=this,r=n.field;n.blankText=t;if("placeholder"in document.createElement("input")){n.field.attr("placeholder",t)}else{var i=e.fn.val;r.overrideNodeMethod("val",function(){var e=i.apply(r,arguments);if(!arguments.length)if(e==n.blankText)return"";else return e});r.focusin(function(){if(i.call(r)==n.blankText)r.val("");r.removeClass(n.blankCls)}).blur(function(){var e=r.val();if(e===n.blankText||!e.length)r.addClass(n.blankCls).val(n.blankText)});console.log(r.val().length);if(!r.val().length)r.addClass(this.blankCls).val(t)}return t},setListeners:function(e){var n=this,r=null;e.field.focusin(function(){r=n.field.val()}).blur(function(){if(r!=n.field.val())n.setChanged()});if(this.setListeners!==t.Text.prototype.setListeners)this.setListeners(this);return e.field},fieldText:function(e){this.field.val(e);if(this.blankText&&this.blankText.length)this.setBlankText(this.blankText)},getVal:function(){return this.value=this.field.val()&&this.field.val().length?this.field.val():null},setVal:function(t){this.fieldText(this.value=t&&e.trim(t).length?t:null)}});t.Textarea=function(t){e.extend(this,t,{field:e("<textarea>"),height:100});this.init()};t.Textarea.prototype=e.extend(new t.Text,{init:function(){t.Text.prototype.init.call(this);this.field.css({height:this.field.parent().parent().height})}});t.Wysiwyg=function(t){e.extend(this,{showHTML:false},t,{blankText:null,field:e("<textarea>")});this.init()};t.Wysiwyg.prototype=e.extend(new t.Textarea,{onRender:function(){var e=[["bold","italic","underline","strikethrough"],["link","unlink","unorderedlist","orderedlist"],["justifyleft","justifycenter","justifyright"]];if(this.showHTML)e.push(["html"]);this.field.htmlarea({css:"body { color:#333; font:90%  Arial, Verdana, Helvetica, sans-serif !important; overflow:hidden; }"+"a {color:#09c; text-decoration:none;} a:hover {color:#0c9; text-decoration:underline;}",toolbar:e,loaded:function(){}});var n=this.field.parent(".wui-html").height(this.height).find("iframe");this.field.attr({tabindex:"-1"});this.field.parent(".wui-html").resizable({animateEasing:"linear",minWidth:this.field.outerWidth(),maxWidth:this.field.outerWidth(),minHeight:this.field.parent(".wui-html").find(".tools").outerHeight()*3,start:function(e,t){this.iFrameOrigHeight=n.height()},resize:function(e,t){n.height(t.size.height-(t.originalSize.height-this.iFrameOrigHeight))},handles:"se"});t.FormField.prototype.onRender.call(this)},setBlankText:function(){},setListeners:function(t){e(t.field).change(function(){t.val()})},valChange:function(){this.field.keyup()}});t.Radio=function(t){e.extend(this,{buttonStyle:false,name:"wui-radio",options:[],template:'<li><input type="radio" id="{id}" value="{val}" name="{name}" /><label for="{id}">{title}</label></li>'},t,{el:e("<div>")});this.init()};t.Radio.prototype=e.extend(new t.FormField,{init:function(){t.FormField.prototype.init.call(this);this.el.addClass("wui-radio");var n=this,r=new t.Template({template:this.template}),i=e("<ul>");e.each(n.options,function(s,o){o.name=n.name;o.id=t.id();i.append(r.make(r.data=o).children("label").attr({unselectable:"on"}).keyup(function(t){if(t.keyCode==13||t.keyCode==32)e(this).click()}).end().children("input").change(function(){n.elemChange(e(this))}).focus(function(){i.addClass("has-focus")}).blur(function(){i.removeClass("has-focus")}).end())});if(n.buttonStyle){i.addClass("button");i.find("label").attr({tabindex:0})}n.el.append(i)},elemChange:function(e){this.val(e.val())},onRender:function(){var n=this;n.el.find("input").each(function(){e(this).css({margin:"0 5px 0"+(n.buttonStyle?-1:0)*(5+e(this).outerWidth())+"px"})});t.FormField.prototype.onRender.call(n)},getVal:function(){return this.value},setVal:function(e){this.value=e;this.el.find("input[value='"+e+"']").attr("checked",true)}});t.Checkbox=function(t){e.extend(this,{name:"wui-checkbox",template:'<li><input type="checkbox" id="{id}" value="{val}" name="{name}" /><label for="{id}">{title}</label></li>'},t);this.init()};t.Checkbox.prototype=e.extend(new t.Radio,{calcVal:function(){var t=this,n=[];t.el.find("input:checked").each(function(){n.push(e(this).val())});return n.length>0?n.length>1?n:n[0]:null},elemChange:function(e){this.val(this.calcVal())},init:function(){if(this.options.length===0)this.options.push({val:1,title:""});t.Radio.prototype.init.call(this);this.el.removeClass("wui-radio").addClass("wui-checkbox");if(this.options.length==1){this.el.find("li label").text(this.el.children("label").text());this.el.children("label").text("")}},getVal:function(){return this.calcVal()},setVal:function(t){var n=this;if(e.isArray(t)){n.value=t}else if(t===null){n.value=null}else{n.value=[t]}if(n.options.length==1&&(typeof t=="number"||typeof t=="string")){n.el.find("input").prop("checked",!!parseInt(t)).siblings("li").toggleClass("checked",!!parseInt(t))}else{n.el.find("input").attr("checked",false);n.el.find("label").removeClass("checked");if(n.value&&n.value.length)for(var r=0;r<n.value.length;r++)n.el.find("input[value="+n.value[r]+"]").prop("checked",true).siblings("li").addClass("checked")}},validTest:function(){if(this.required&&this.val()===0)return false;return true}});e.expr[":"].contains=e.expr.createPseudo(function(t){return function(n){return e(n).text().toUpperCase().indexOf(t.toUpperCase())>=0}});t.Combo=function(t){e.extend(this,{autoLoad:false,ddCls:"",dataName:null,emptyText:"(empty)",field:e("<input>").attr({type:"text"}),keepInline:false,minKeys:2,onBlur:function(){},searchLocal:true,titleItem:null,valueItem:null},t,{cls:t.cls?t.cls+" wui-combo":"wui-combo"});if(this.hasOwnProperty("valueItem")&&this.hasOwnProperty("titleItem")&&!this.hasOwnProperty("template")&&this.valueItem.length&&this.valueItem.length>0&&this.titleItem.length&&this.titleItem.length>0)this.template="<li>{"+this.titleItem+"}</li>";this.init()};t.Combo.prototype=e.extend(new t.Text,new t.Data,{enterKey:function(){if(this.selectItm!==null)this.selectItm.click()},keyDown:function(){if(!this.dd.is(":visible")){this.selectCurr();this.showDD();this.field.select()}else{var e=this.selectItm===null?0:this.dd.children(".selected ~ :visible:first").index(),t=e>0?e:0;this.rsltHover(this.dd.children(":eq("+t+")"))}},keyUp:function(){if(this.selectItm!==null){var e=this.selectItm.prevAll(":visible:first").index();if(e<0){this.field.focus().select();this.dd.children().removeClass("selected");this.selectItm=null}else{this.rsltHover(this.dd.children(":eq("+e+")"))}}},hideDD:function(){this.dd.hide()},init:function(){var n=this,r=n.keepInline?"wui-inline-dd":"";n.tplEngine=new t.Template({template:n.template});n.selectItm=null;t.Text.prototype.init.call(n);n.wrapper=e("<div>").addClass("dd-wrapper");n.ddSwitch=new t.Button({click:function(){if(!n.dd.is(":visible")){n.field.focus();n.selectCurr();n.showDD()}else{n.hideDD()}},text:"",tabIndex:-1,appendTo:n.wrapper,cls:"field-btn dd-switch"});n.append(n.wrapper.append(n.dd=e("<ul>").addClass("wui-combo-dd "+r+" "+n.ddCls),n.field.addClass("has-dd")));n.ddSwitch.place();if(n.dataName&&n.dataName.length>0){e(window).on("datachanged",function(e,t,r){if(t==n.dataName)n.setData(r.data)})}else{if(n.autoLoad)n.loadData();else n.renderData()}},renderData:function(){var t=this,n=e("<ul>");t.dd.html("");if(t.total){t.dataEach(function(e,r){t.tplEngine.data=e;n.append(t.tplEngine.make().mouseenter(function(e){t.rsltHover(e)}).mousedown(function(e){t.field.isBlurring=false}).click(function(){t.rsltClick()}))});t.dd.append(n.children().unwrap())}else{t.dd.html(this.emptyText)}return true},rsltClick:function(){this.hideDD();this.val(this.data[this.selectItm.index()])},rsltHover:function(t){if(!t.addClass)t=e(t.currentTarget);this.dd.children().removeClass("selected");this.selectItm=t.addClass("selected")},setParams:function(){if(this.searchFilter)e.extend(this.params,{srch:this.searchFilter})},searchData:function(e){this.searchFilter=e;if(this.searchLocal){this.showDD();this.dd.children()[e&&e.length>0?"hide":"show"]();this.dd.children(":contains("+e+")").show();this.rsltHover(this.dd.children(':contains("'+e+'"):first'))}else{if(e.length>=this.minKeys||e.length===0)this.loadData()}},selectCurr:function(e){if(e===undefined&&this.value!==null){for(var t in this.data){if(this.data[t][this.valueItem]===(this.value[this.valueItem]||this.value)){e=t;break}}}this.rsltHover(this.dd.children(":eq("+e+")"))},afterSet:function(){this.renderData()},setListeners:function(t){t.field.focus(function(e){t.field.isBlurring=undefined}).blur(function(e){if(t.field.isBlurring!==false){t.hideDD();var n=false;for(var r in t.data){if(t.field.val()==t.data[r][t.titleItem]){n=true;break}}if(!n)t.val(null);t.onBlur()}}).click(function(){t.showDD();t.field.select()}).keyup(function(e){var n=t.field.val();switch(e.keyCode){case 40:break;case 38:break;case 13:break;case 9:break;default:t.searchData(n)}}).keydown(function(n){var r=t.field.val();if(r.length===0)t.value=null;if(t.data.length>0){switch(n.keyCode){case 40:t.keyDown();break;case 38:t.keyUp();break;case 13:case 9:t.enterKey();break}if(t.selectItm!==null){var i=0;t.selectItm.siblings(":lt("+t.selectItm.index()+"):visible").each(function(){i+=e(this).outerHeight()});t.selectItm.parent().animate({scrollTop:i},100)}}});return t.field},showDD:function(){if(!this.keepInline){var n=this.field,r=n.offset(),i=parseInt(this.dd.css("width")),s=i&&i>n.outerWidth()?i:n.outerWidth()-1;this.dd.appendTo("body").css({left:r.left+(r.left+s<e.viewportW()?0:n.outerWidth()-s),top:r.top+n.outerHeight(),width:s,display:"block",zIndex:t.maxZ()})}else{this.dd.css({zIndex:t.maxZ()}).show()}},getVal:function(){var e=this;return e.value&&e.value[e.valueItem]?e.value[e.valueItem]:e.value},setVal:function(e){var t=this,n=null;if(e===null){t.value=null;t.renderData();t.fieldText("")}else if(typeof e=="object"){t.value=e;var r=true;for(var i in t.data)if(t.data[i]==e)r=false;if(r){t.data.push(t.value);t.renderData()}n=t.value[t.valueItem]}else{t.value=e;n=t.value}t.dataEach(function(e,r){if(e[t.valueItem]===n){t.selectCurr(r);t.fieldText(e[t.titleItem]);return false}})}});t.Link=function(t){e.extend(this,{invalidMsg:"The value for '"+(this.label?this.label:this.args&&this.args.name?this.args.name:"a link field")+"' is not a properly formatted link."},t);this.init()};t.Link.prototype=e.extend(new t.FormField,{buildOutput:function(){if(this.outputFld===undefined)this.elAlias.append(this.outputFld=e("<div>").attr({tabindex:-1}).addClass("feedback"));if(this.testLink()){var n=new t.Template({data:this.value,template:'<span>Preview:</span> <a href="{uri}" target="{target}" class="{((target == "_blank") ? "uri-new-win" : "")}">{title}</a>'});this.outputFld.html(n.make())}else{this.outputFld.html("Your link is improperly formatted.")}},init:function(){var n=this;n.items=[n.urlField=new t.Text({cls:"wui-link-third wui-link-focus",blankText:"URL",linkData:"uri"}),n.titleField=new t.Text({cls:"wui-link-third",blankText:"Display Text",linkData:"title"}),n.targetField=new t.Combo({cls:"wui-link-third no-margin",valueItem:"target",titleItem:"name",blankText:"Target",keepInline:true,data:[{target:"_self",name:"Opens In Same Window"},{target:"_blank",name:"Opens In New Window/Tab"}],linkData:"target"})];t.FormField.prototype.init.call(n);n.value={target:"_self",title:null,uri:null};n.el.append(n.elAlias=e("<div>").addClass("wui-hyperlink"));n.setListeners(n.urlField,n.titleField,n.targetField);n.targetField.val(n.value.target);n.urlField.field.keyup(function(t){if(n.titleField.field.val()==n.titleField.blankText)n.value.title=null;if(n.value.title===null)n.titleField.val(e(this).val())}).blur(function(){n.value.title=n.titleField.val()})},setListeners:function(){var t=this,n=arguments;e.each(n,function(r,i){(i.field.field||i.field).on("blur click keyup keydown mousedown",null,i,function(e){var n=e.data.val();if(n!==null&&n!={})t.value[e.data.linkData]=n;t.buildOutput()}).on("focus",null,i,function(t){e.each(n,function(e,t){t.el.removeClass("wui-link-focus")});t.data.el.addClass("wui-link-focus")})})},testLink:function(){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,n=/(\/|\/([\w#!:.?+=&%@!\-\/]))/;return t.test(this.value.uri)||n.test(this.value.uri)},getVal:function(){return this.value},setVal:function(t){e.extend(this.value,t);this.urlField.val(this.value.uri);this.titleField.val(this.value.title);this.targetField.val(this.value.target);this.buildOutput()},validTest:function(){if(this.required&&!this.testLink())return false;return true}});t.Datetime=function(t){e.extend(this,t,{field:e("<input>").attr({type:"text"})});this.init()};e.extend(Date,{CultureInfo:{name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM"},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,Date.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getTimezoneOffset:function(e,t){return t||false?Date.CultureInfo.abbreviatedTimeZoneDST[e.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[e.toUpperCase()]},getTimezoneAbbreviation:function(e,t){var n=t||false?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard,r;for(r in n){if(n[r]===e){return r}}return null}});e.extend(Date.prototype,{getDaysInMonth:function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())},addMilliseconds:function(e){this.setMilliseconds(this.getMilliseconds()+e);return this},addSeconds:function(e){return this.addMilliseconds(e*1e3)},addMinutes:function(e){return this.addMilliseconds(e*6e4)},addHours:function(e){return this.addMilliseconds(e*36e5)},addDays:Date.prototype.addDays=function(e){return this.addMilliseconds(e*864e5)},addWeeks:function(e){return this.addMilliseconds(e*6048e5)},addMonths:function(e){var t=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+e);this.setDate(Math.min(t,this.getDaysInMonth()));return this},addYears:function(e){return this.addMonths(e*12)},add:function(e){if(typeof e=="number"){this._orient=e;return this}var t=e;if(t.millisecond||t.milliseconds){this.addMilliseconds(t.millisecond||t.milliseconds)}if(t.second||t.seconds){this.addSeconds(t.second||t.seconds)}if(t.minute||t.minutes){this.addMinutes(t.minute||t.minutes)}if(t.hour||t.hours){this.addHours(t.hour||t.hours)}if(t.month||t.months){this.addMonths(t.month||t.months)}if(t.year||t.years){this.addYears(t.year||t.years)}if(t.day||t.days){this.addDays(t.day||t.days)}return this},getDayName:function(e){return e?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]},getMonthName:function(e){return e?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]},_toString:Date.prototype.toString,toString:function(e){var t=this;var n=function(t){return t.toString().length==1?"0"+t:t};return e?e.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(e){switch(e){case"hh":return n(t.getHours()<13?t.getHours():t.getHours()-12);case"h":return t.getHours()<13?t.getHours():t.getHours()-12;case"HH":return n(t.getHours());case"H":return t.getHours();case"mm":return n(t.getMinutes());case"m":return t.getMinutes();case"ss":return n(t.getSeconds());case"s":return t.getSeconds();case"yyyy":return t.getFullYear();case"yy":return t.getFullYear().toString().substring(2,4);case"dddd":return t.getDayName();case"ddd":return t.getDayName(true);case"dd":return n(t.getDate());case"d":return t.getDate().toString();case"MMMM":return t.getMonthName();case"MMM":return t.getMonthName(true);case"MM":return n(t.getMonth()+1);case"M":return t.getMonth()+1;case"t":return t.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return t.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return""}}):this._toString()}});t.Datetime.prototype=e.extend(new t.Text,{second:1e3,minute:6e4,hour:36e5,day:864e5,days:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],shortDays:["sun","mon","tue","wed","thu","fri","sat"],months:["january","february","march","april","may","june","july","august","september","october","november","december"],shortMonths:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],sarcasmArray:["Not quite.","Huh?","Nope","Arg..","Sorry","What?","Bleck.","Nuh-uh.","Keep Trying.","No Entiendo."],minDate:null,displayDate:function(e){var t=this;if(e!==undefined){t.displayDiv.html(e);return e}if(t.value===""||t.value===null){return null}if(!(t.minDate!==null&&t.value<t.minDate))t.displayDiv.html(t.value.toString("ddd MM-dd-yyyy h:mm tt"));else t.displayDiv.html(t.value.toString("Less than minimum required date of MM-dd-yyyy"));return t.value.toString("MM/dd/yyyy h:mm tt")},getM:function(e){var t=0;while((e=e/10)>=1)t++;return t},init:function(){var n=this;t.Text.prototype.init.call(n);n.append(e("<div>").addClass("wui-date").append(n.setListeners(n),n.displayDiv=e("<div>").addClass("feedback").attr({tabindex:-1})));n.field.datepicker({autoSize:true,buttonText:"",showOn:"button",minDate:n.minDate,constrainInput:false,beforeShow:function(r,i){e(i).css({zIndex:t.maxZ()});if(n.validDate(n.value))n.field.datepicker("setDate",n.value);else n.val("")},onSelect:function(e,t){if(n.value!==null){n.value.setDate(t.selectedDay);n.value.setMonth(t.selectedMonth);n.value.setYear(t.selectedYear)}else{n.value=n.field.datepicker("getDate")}n.val(n.displayDate())}});n.el.find(".ui-datepicker-trigger").attr({tabindex:-1})},num2Dec:function(t){var n={a:1,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20,thirty:30,forty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90,hundred:100,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18};t=t.toString().replace(/ and /g," ").replace(/-/g," ");e.each(n,function(e,r){t=t.replace(new RegExp("(^|[ ]|-)"+r+"(-|[ ]|$)","g")," "+n[r]+" ")});var r=e.trim(t).split(/[ ]+/),i=[],s=0,o=0;while(r[o]){if(this.getM(r[o])>2){i.push(r.splice(0,o+1));o=0}o++}i.push(r);for(var u=0;u<i.length;u++){var a=this.txt2Num(i[u]);if(parseInt(a))s+=parseInt(a)}return s},processDate:function(e){var n=this,r=e||n.field.val();if(r.length>0){var i=n.translateDate(r);if(i.toString()=="Invalid Date"){n.displayDate(n.sarcasmArray[t.randNum(0,n.sarcasmArray.length-1)]);return}n.value=i;n.displayDate();return i}else{n.value=null;n.displayDate("")}},setListeners:function(e){return e.field.keyup(function(t){e.processDate()})},setMinDate:function(e){var t=this;t.minDate=t.translateDate(e.toString());t.field.datepicker("option","minDate",new Date(t.minDate.valueOf()+t.minute));return t.minDate},translateDate:function(t){var n=this,r=new Date,i=t,s=/\d{1,2}\/\d{1,2}\/\d{2,4}/,o=/([a|one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve|twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety|hundred|thousand|million|billion|trillion|and,\d,\s,-]+)\s((millisecond|second|minute|hour|day|week|month|year)+[s]*)\s(from|after|before|previous to)+\s(.+)$/,u=o.exec(t.toLowerCase());if(u!==null){var a=n.num2Dec(u[1]),f={from:1,after:1,before:-1,"previous to":-1},l=f[u[4]],c=n.translateDate(u[5]);return c["add"+u[3].charAt(0).toUpperCase()+u[3].slice(1)+"s"](a*l)}if(t.toLowerCase().match(/now/)!==null){return r}t=t.toLowerCase().replace("noon","12").replace("midnight","00:00").replace(/o.clock/,"").replace(/(\d+)[st|nd|rd|th]+/,function(e,t){return t}).replace(/(\d{4})-(\d{1,2})-(\d{1,2})/g,function(e,t,n,r){return n+"/"+r+"/"+t}).replace(/(\d{1,2})-(\d{1,2})-(\d{2,4})/g,function(e,t,n,r){return t+"/"+n+"/"+r}).replace(/^(\d{1,2})-(\d{1,2})[\s]*/,function(e,t,n){return t+"/"+n+" "}).replace("at","@").replace(/(today|tomorrow|yesterday)/,function(e,t){var i={today:0,tomorrow:1,yesterday:-1},s=new Date(r.valueOf()+n.day*i[t]);return s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear()}).replace(/(next|last) ([a-z]{3,10})[ ]*([0-9]+)*/,function(t,i,s,o){var u=n.day*(i=="next"?1:-1),a=e.inArray(s,n.days)>-1?e.inArray(s,n.days):e.inArray(s,n.shortDays),f=e.inArray(s,n.months)>-1?e.inArray(s,n.months):e.inArray(s,n.shortMonths),l=a>-1?a:f>-1?f:-1,c=a>-1?"getDay":f>-1?"getMonth":"";if(l>-1){var h=r.valueOf(),p=new Date(h+=u);while(p[c]()!=l)p=new Date(h+=u);if(f!==undefined&&f!=-1&&o.length!==0)p.setDate(parseInt(o));return p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear()+" "}else{return""}}).replace(/(\d{1,2})[ -]+([a-z]{3,10})([ -]*)/,function(t,r,i,s){return(e.inArray(i,n.months)>-1?e.inArray(i,n.months):e.inArray(i,n.shortMonths))+1+"/"+r+s.replace("-"," ")}).replace(/(\b(one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve|twenty|thirty|forty|fifty|-)+\b)/g,function(e,t){return n.num2Dec(t)}).replace(/([a-z]{3,10}) (\d{1,2})[,]*/,function(t,r,i){return(e.inArray(r,n.months)>-1?e.inArray(r,n.months):e.inArray(r,n.shortMonths))+1+"/"+i}).replace(/^(\d{1,2}\/\d{1,2}(?![\d]))([\s|\/]*)(\d{0,4})/,function(e,t,i,s){if(s.length==2){var o=parseInt(r.getFullYear().toString().substr(2,4)),u=parseInt(r.getFullYear().toString().substr(0,2))*100,a=parseInt(s),f=100-a,l=o<50?-100*(f>=50?0:1):100*(f<50?0:1),c=u+a+l;return t+"/"+c}else if(s.length==4){return t+"/"+s}else{var h=t+"/"+r.getFullYear().toString(),p=new Date(h);return p.valueOf()>r.valueOf()?h:t+"/"+(new Date(r.valueOf()+n.day*365)).getFullYear()+" "}}).replace(/(\d{1,2}\/\d{1,2})\s(\d{4})/,function(e,t,n){return t+"/"+n});t=s.test(t)===true?t:r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()+" "+t;t=t.replace(/(\d{1,2}\/\d{1,2}\/\d{4})\s(.+)/,function(e,t,n){if(n.indexOf("@")==-1)n="@ "+n;return t+" "+n}).replace(/\d[ ]*[a|p]$/,function(e){return e+"m"}).replace(/[a|p][.][m]*[.]*/,function(e){return e.replace(/[.]/g,"")}).replace(/\d.m/,function(e){return e.substring(0,e.length-2)+" "+e.substring(e.length-2,3)}).replace(/@ (\d+[ ]\d+)/,function(e,t){return t.replace(" ",":")}).replace(/@ (\d+)/,function(e,t,n,r){if(r.indexOf(":")!=-1)return e;else return e.trim()+":00 "}).replace(/@/g,"");return new Date(t)},txt2Num:function(e){var t=0,n=0,r=0,i=0;if(e.length==1){return e[0]}else{while(e[t+1]!==undefined){var s=parseInt(e[t]),o=this.getM(s)<=this.getM(r);r=parseInt(e[t+1]);i=parseInt(e[e.length-1]);if(t===0){n=o?s*r:s+r}else{if(o)n*=r;else n+=r}t++}}if(i!=r)return this.getM(i)>2?n*=i:n+=i;else return n},getVal:function(){return this.value},setVal:function(e){if(e!==null){if(typeof e=="string"){this.fieldText(e);this.processDate()}else{this.value=e;this.fieldText(this.displayDate())}}else{this.fieldText("");this.displayDiv.html("");this.value=null}},validDate:function(e){if(e!==null&&e.toString()=="Invalid Date")return false;else if(e===null)return false;else return true}});t.File=function(t){e.extend(this,{beforeSubmit:function(){},fileTypeFilter:null,upFieldName:"fileupload",params:{},upSuccess:function(){},url:"",upTitleName:"title"},t,{field:e("<input>").attr({type:"text"})})};t.File.prototype=e.extend(new t.Text,{changeClick:function(){this.changeBtn.el.fadeOut("fast");this.upBtn.el.parents("div:first").fadeIn("slow");this.field.removeClass().focus()},init:function(){var n=this;t.Text.prototype.init.call(n);n.append(n.wrapper=e("<div>").addClass("wui-file").append(n.field));n.elAlias=n.wrapper;var r=t.id();n.push(n.iframe=new t.O({el:e("<iframe>").css({display:"none"}).attr({id:r,name:r})}),n.changeBtn=new t.Button({click:function(){n.fieldText("");n.field.removeAttr("disabled");n.changeClick()},text:"X",tabIndex:-1,cls:"file-change field-btn"}),n.upBtn=new t.Button({text:"Browse",cls:"field-btn",tabIndex:-1}),n.fileFrm=new t.O({el:e("<form>").attr({method:"post",enctype:"multipart/form-data",action:n.url,target:r})}));n.fileFrm.append(n.fileInput=e("<input>").attr({name:n.upFieldName,type:"file"}).change(function(){n.submit()}).focus(function(){n.upBtn.el.addClass("selected")}).blur(function(){n.upBtn.el.removeClass("selected")}))},submit:function(){var t=this;t.beforeSubmit();t.params[t.upTitleName]=t.field.val();if(t.fileTypeFilter!==null)t.params[file_type_filter]=t.fileTypeFilter;t.field.addClass("has-file uploading").attr("disabled",true).val("uploading...");t.fileFrm.el.children("input[type!='file']").remove();e.each(t.params,function(n,r){t.fileFrm.append(e("<input>").attr({type:"hidden",name:n,value:r}))});t.fileFrm.el.submit();t.iframe.el.unbind().load(function(){t.onComplete(e("body",t.iframe.el.contents()).text())})},devHook:function(){},onComplete:function(n){try{var r=this,i=e.parseJSON(n),s=t.unwrapData.call(r,i);r.devHook(s);r.field.removeClass("uploading empty");if(i.success===true){r.val(s.data,"upSuccess")}else{if(i.errors&&i.errors[0]&&i.errors[0].fileTypeError){t.errRpt(i.errors[0].fileTypeError,"Invalid File Type");r.field.removeClass("has-file uploading").removeAttr("disabled");if(r.beforeSelectTitle)r.fieldText(r.beforeSelectTitle)}else{r.upFailure(i)}}}catch(o){console.log(o,n);r.upFailure(o,n)}},upFailure:function(e,n){console.log(e,n);t.Text.prototype.val.call(this,"Upload Failure")},getVal:function(){return this.value||{}},setVal:function(t){this.value=this.value||{};e.extend(this.value,t)},val:function(e,n){var r=t.FormField.prototype.val.apply(this,arguments);if(this[n]&&typeof this[n]=="function")this[n]();return r},valChange:function(){var e=this;if(e.value){e.field.addClass("has-file").removeAttr("disabled");e.upBtn.hide();e.fileFrm.hide();asdf=e.upBtn;e.changeBtn.show();e.field.addClass("has-file "+(e.value.extension!==undefined?"icon-"+e.value.extension.replace(".",""):"")).attr("disabled",true);e.fieldText(e.value[e.upTitleName])}else{e.field.removeClass();e.upBtn.show();e.fileFrm.show();e.changeBtn.hide();e.field.val(null)}}});t.input=function(n,r,i,s,o){if(s){if(!s.length){if(s instanceof t.FormField||s.ftype)s=[s];else s=[{ftype:"Wui.Text"}]}}else{s=[{ftype:"Wui.Text"}]}if(s.length==1)e.extend(s[0],{label:n,required:true,name:"inputField"});if(o!==undefined)s.splice(0,0,{ftype:"Wui.Note",html:o});var u=new t.Form({labelPosition:"left",items:s}),a=new t.Window({title:i||"Input",bbar:[new t.Button({text:"Cancel",click:function(){a.answerRun=true;a.close()}}),new t.Button({text:"Submit",click:function(){a.getVal()}})],isModal:true,items:[u],cls:"wui-input-window",width:600,height:250,getVal:function(){var e=u.getData();if(e){if(r&&typeof r=="function"){var n=t.getKeys(e).length;if(n==1&&e.inputField)r(e.inputField);else r(e)}a.answerRun=true;a.close()}},onWinClose:function(){return a.answerRun!==true?false:a.answerRun}});a.header.splice(0,1);return u};e.fn.htmlarea=function(e){if(e&&typeof e==="string"){var t=[];for(var r=1;r<arguments.length;r++){t.push(arguments[r])}var i=n(this[0]);var s=i[e];if(s){return s.apply(i,t)}}return this.each(function(){n(this,e)})};var n=window.jHtmlArea=function(e,t){if(e.jquery){return n(e[0])}if(e.jhtmlareaObject){return e.jhtmlareaObject}else{return new n.fn.init(e,t)}};n.fn=n.prototype={jhtmlarea:"0.7.5",init:function(t,i){if(t.nodeName.toLowerCase()==="textarea"){var s=e.extend({},n.defaultOptions,i);t.jhtmlareaObject=this;var o=this.textarea=e(t);var u=this.container=e("<div/>").addClass("wui-html").insertAfter(o);var a=this.toolbar=e("<div/>").addClass("tools").appendTo(u);r.initToolBar.call(this,s);var f=this.iframe=e("<iframe/>");var l=this.htmlarea=e("<div/>").append(f);u.append(l).append(o.hide());r.initEditor.call(this,s);r.attachEditorEvents.call(this);f.height(f.height()-a.height());a.width(o.width()-2);if(s.loaded){s.loaded.call(this)}}},dispose:function(){this.textarea.show().insertAfter(this.container);this.container.remove();this.textarea[0].jhtmlareaObject=null},execCommand:function(e,t,n){this.iframe[0].contentWindow.focus();this.editor.execCommand(e,t||false,n||null);this.updateTextArea()},ec:function(e,t,n){this.execCommand(e,t,n)},queryCommandValue:function(e){this.iframe[0].contentWindow.focus();return this.editor.queryCommandValue(e)},qc:function(e){return this.queryCommandValue(e)},getSelectedHTML:function(){var t=this.getRange();if(t.htmlText)return t.htmlText;else return e("<p>").append(e(t.cloneContents())).html()},getSelection:function(){if(this.editor.selection)return this.editor.selection;else return this.iframe[0].contentDocument.defaultView.getSelection()},getRange:function(){var e=this.getSelection();if(!e){return null}return e.getRangeAt?e.getRangeAt(0):e.createRange()},html:function(e){if(e){this.textarea.val(e);this.updateHtmlArea()}else{return this.toHtmlString()}},pasteHTML:function(t){this.iframe[0].contentWindow.focus();var n=this.getRange();if(n.pasteHTML){n.pasteHTML(t)}else{n.deleteContents();n.insertNode(e(t.indexOf("<")!==0?e("<span/>").append(t):t)[0])}n.collapse(false);n.select()},bold:function(){this.ec("bold")},italic:function(){this.ec("italic")},underline:function(){this.ec("underline")},strikeThrough:function(){this.ec("strikethrough")},removeFormat:function(){this.ec("removeFormat",false,[]);this.unlink()},link:function(){if(this.getRange().htmlText)this.ec("createLink",true);else this.ec("createLink",false,prompt("Link URL:","http://"))},unlink:function(){this.ec("unlink",false,[])},unorderedList:function(){this.ec("insertunorderedlist")},orderedList:function(){this.ec("insertorderedlist")},justifyLeft:function(){this.ec("justifyLeft")},justifyCenter:function(){this.ec("justifyCenter")},justifyRight:function(){this.ec("justifyRight")},formatBlock:function(e){this.ec("formatblock",false,e||null)},showHTMLView:function(){this.updateTextArea();this.textarea.show();this.htmlarea.hide();e("ul li:not(li:has(a.html))",this.toolbar).hide();e("ul:not(:has(:visible))",this.toolbar).hide();e("ul li a.html",this.toolbar).addClass("highlighted");this.container.css({height:"auto"});this.textarea.css({paddingBottom:"28px"})},hideHTMLView:function(){this.updateHtmlArea();this.textarea.hide();this.htmlarea.show();e("ul",this.toolbar).show();e("ul li",this.toolbar).show().find("a.html").removeClass("highlighted")},toggleHTMLView:function(){if(this.textarea.is(":hidden"))this.showHTMLView();else this.hideHTMLView()},toHtmlString:function(){return e.trim(this.editor.body.innerHTML.replace(/MsoNormal/gi,"").replace(/<\/?link[^>]*>/gi,"").replace(/<\/?meta[^>]*>/gi,"").replace(/<\/?xml[^>]*>/gi,"").replace(/<\?xml[^>]*\/>/gi,"").replace(/<!--(.*)-->/gi,"").replace(/<!--(.*)>/gi,"").replace(/<!(.*)-->/gi,"").replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,"").replace(/<w:[^>]*\/>/gi,"").replace(/<\/?w:[^>]*>/gi,"").replace(/<m:[^>]*\/>/gi,"").replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,"").replace(/<o:[^>]*>([.|\s]*)<\/o:[^>]*>/gi,"").replace(/<o:[^>]*>/gi,"").replace(/<o:[^>]*\/>/gi,"").replace(/<\/o:[^>]*>/gi,"").replace(/<\/?m:[^>]*>/gi,"").replace(/style=\"([^>]*)\"/gi,"").replace(/style=\'([^>]*)\'/gi,"").replace(/class=\"(.*)\"/gi,"").replace(/class=\'(.*)\'/gi,"").replace(/<p[^>]*>/gi,"<p>").replace(/<\/p[^>]*>/gi,"</p>").replace(/<span[^>]*>/gi,"").replace(/<\/span[^>]*>/gi,"").replace(/<st1:[^>]*>/gi,"").replace(/<\/st1:[^>]*>/gi,"").replace(/<font[^>]*>/gi,"").replace(/<\/font[^>]*>/gi,"").replace(/[\r\n]/g," ").replace(/<wordPasteong><\/wordPasteong>/gi,"").replace(/<p><\/p>/gi,"").replace(/\/\*(.*)\*\//gi,"").replace(/<!--/gi,"").replace(/-->/gi,"").replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,"").replace(/<hr>/gi,""))},toString:function(){return this.editor.body.innerText},updateTextArea:function(){this.textarea.val(this.toHtmlString());this.textarea.change()},updateHtmlArea:function(){this.editor.body.innerHTML=this.textarea.val()}};n.fn.init.prototype=n.fn;n.defaultOptions={toolbar:[["bold","italic","underline","link","unlink","strikethrough","orderedlist","unorderedlist"],["justifyleft","justifycenter","justifyright"]],css:null,toolbarText:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strike-Through",justifyleft:"Left Justify",justifycenter:"Center Justify",justifyright:"Right Justify",link:"Insert Link",unlink:"Remove Link",unorderedlist:"Insert Unordered List",orderedlist:"Insert Ordered List",html:"Show/Hide HTML Source View"}};var r={toolbarButtons:{strikethrough:"strikeThrough",unorderedlist:"unorderedList",orderedlist:"orderedList",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",html:function(e){this.toggleHTMLView()}},initEditor:function(t){var n=this.editor=this.iframe[0].contentWindow.document;n.designMode="on";n.open();n.write(this.textarea.val());n.close();if(t.css)e("head",n).append(e("<style>").attr({type:"text/css"}).text(t.css))},initToolBar:function(t){function s(s){var o=e("<ul/>").appendTo(n.toolbar);for(var u=0;u<s.length;u++){var a=s[u];if((typeof a).toLowerCase()==="string"){if(a==="|"){o.append(e('<li class="separator"/>'))}else{var f=function(e){var t=r.toolbarButtons[e]||e;if((typeof t).toLowerCase()==="function"){return function(e){t.call(this,e)}}else{return function(){this[t]();this.editor.body.focus()}}}(a.toLowerCase());var l=t.toolbarText[a.toLowerCase()];o.append(i(a.toLowerCase(),l||a,f))}}else{o.append(i(a.css,a.text,a.action))}}}var n=this;var i=function(t,r,i){return e("<li/>").append(e('<a href="javascript:void(0);" tabindex="-1"/>').addClass(t).attr("title",r).click(function(){i.call(n,e(this))}))};if(t.toolbar.length!==0&&r.isArray(t.toolbar[0])){for(var o=0;o<t.toolbar.length;o++){s(t.toolbar[o])}}else{s(t.toolbar)}},attachEditorEvents:function(){function n(e){t.toolbar.css("opacity",100*(e.type!="blur"?1:0))}function r(e){t.updateHtmlArea();n(e)}function i(e){t.updateTextArea();n(e)}var t=this;this.textarea.click(r).keyup(r).keydown(r).mousedown(r).blur(r);e(this.editor).focus(i).click(i).keyup(i).keydown(i).mousedown(i).blur(i)},isArray:function(e){return e&&typeof e==="object"&&typeof e.length==="number"&&typeof e.splice==="function"&&!e.propertyIsEnumerable("length")}}})(jQuery,Wui);(function($,Wui){Wui.Tabs=function(e){$.extend(this,{bbar:[],items:[],tabsLeft:false,currentTab:null,tabsBottom:false,tabsHideHeader:null,tbar:[]},e);this.init()};Wui.Tabs.prototype=$.extend(new Wui.Pane,{init:function(){if(this.title===null)this.title="";Wui.Pane.prototype.init.call(this)},place:function(){var e=this;e.el.addClass("wui-tabs");if(e.items===undefined)e.items=[];$.each(e.items,function(t,n){n.tabCls="wui-tab "+(n.tabCls?" "+n.tabCls:"")+(e.tabsLeft?" left":"");if(n.tabsHideHeader){n.el.css({borderTopWidth:n.el.css("border-left-width")});n.el.addClass("wui-hide-heading")}e[e.tabsBottom?"footer":"header"].push(n.tab=new Wui.Button({text:n.title||"Tab "+(parseInt(t)+1),click:function(){e.giveFocus(n);if(n.layout&&typeof n.layout==="function")n.layout()},cls:n.tabCls}));if(e.bbar.length!==0)e.placeFooter()});return Wui.O.prototype.place.call(e,function(e){$.each(e.items,function(e,t){t.el.addClass("wui-tab-panel")})})},giveFocus:function(e,t){var n=this;t=t!==undefined?t:false;$.each(n.items,function(r,i){var s=i===e;i.tab.el.toggleClass("selected",s);i.el.toggleClass("active",s);if(s){n.currentTab=i;i.layout()}if(!t&&s)n.el.trigger($.Event("tabchange"),[n,i.tab,i])})},selectTabByText:function(e,t){var n=this,r=undefined;$.each(n.items,function(i,s){if($.trim(s.tab.text).toLowerCase()===$.trim(e).toLowerCase().replace(/_/g," ")){n.giveFocus(s,t);r=s}});return r},onRender:function(){this.giveFocus(this.items[0])}});Wui.Grid=function(e){$.extend(this,{bbar:[],columns:[],colUrl:null,colParams:{},data:null,defaultDataType:"string",multiSelect:false,hideHeader:false,selected:[],tbar:[]},e);this.init()};Wui.Grid.prototype=$.extend(new Wui.Pane,new Wui.DataList,{afterMake:function(){this.sizeCols();this.removeMask()},doSort:function(e,t,n){var r=this;if(r.sorters.length>0){var i=r.sorters[e],s=t.rec[i.dataItem],o=n.rec[i.dataItem];var u=i.sortDir=="asc"?1:-1;var a=0;switch(i.dataType){case"date":s=new Date(s);o=new Date(o);a=s.getTime()==o.getTime()?0:s.getTime()>o.getTime()?1:-1;break;case"numeric":s=parseFloat(s)?parseFloat(s):0;o=parseFloat(o)?parseFloat(o):0;a=s==o?0:s>o?1:-1;break;default:a=$.trim(s).toUpperCase().localeCompare($.trim(o).toUpperCase())}if(a!==0||r.sorters[e+1]===undefined)return a*u;else return r.doSort(e+1,t,n)}else{return t.rec.wuiIndex>n.rec.wuiIndex?1:-1}},getColumns:function(){var e=this;if(e.colUrl&&e.colUrl.length){e.colProxy=new Wui.Data({url:e.colUrl,params:e.colParams,afterSet:function(t){e.setColumns(t)}});e.colProxy.loadData()}else if(e.columns.length){e.setColumns(e.columns)}else{}},init:function(){var e=this;Wui.Pane.prototype.init.call(e);e.el.addClass("wui-grid");e.tblContainer=$("<div><table></table></div>").addClass("grid-body").appendTo(e.elAlias);e.headingContainer=$("<div><ul></ul></div>").addClass("wui-gh").appendTo(e.elAlias);e.elAlias=e.tbl=e.tblContainer.children("table");e.heading=e.headingContainer.children("ul");e.cols=[];e.sorters=[];if(e.hideHeader)e.headingContainer.height(0)},layout:function(){Wui.O.prototype.layout.call(this);this.posDataWin();if(this.cols.length)this.sizeCols()},loadData:function(){this.setMaskHTML('Loading <span class="wui-spinner"></span>');this.addMask();Wui.Data.prototype.loadData.apply(this,arguments)},mngSorters:function(e,t){var n=this,r=["one","two","three","four","five"];if(t!==undefined){e.sortDir=t;n.sorters.push(e)}else{if(e.sortDir){if(e.sortDir=="desc"){delete e.sortDir;e.el.removeClass().addClass("wui-gc").addClass(e.cls);$.each(n.sorters,function(t,r){if(r==e)n.sorters.splice(t,1)})}else{e.sortDir="desc"}}else{if(n.sorters.length>5){e.el.removeClass().addClass("wui-gc").addClass(e.cls);return false}e.sortDir="asc";n.sorters.push(e)}}$.each(n.sorters,function(e,t){t.el.removeClass().addClass("wui-gc "+r[e]+" "+t.sortDir).addClass(t.cls)})},modifyItem:function(e){var t=this;$.each(t.renderers,function(t,n){var r=e.el.children(":eq("+n.index+")").children("div"),i=e.rec[n.dataItem];r.empty().append(n.renderer.call(null,r,i,e.rec,e.el))});return e.el},onRender:function(){var e=this,t=e.autoLoad;e.autoLoad=false;Wui.DataList.prototype.onRender.call(this);e.autoLoad=t;this.getColumns()},posDataWin:function(){var e=this.headingContainer.height()-1;this.tblContainer.css({height:this.container.height()-e,top:e})},refresh:function(){if(this.url===null)this.setData(this.data);else this.getColumns()},renderColumn:function(col,idx){var me=this;$.extend(col,{dataType:col.dataType||me.defaultDataType,fit:col.fit===undefined?col.width===undefined?1:0:col.fit,cls:col.cls||"",renderer:col.renderer?function(a){if(typeof a!=="function"&&eval("typeof "+a)=="function")a=new Function("return "+a+".apply(this,arguments)");if(typeof a==="function")me.renderers.push({dataItem:col.dataItem,renderer:a,index:idx})}(col.renderer):"",index:idx,width:col.width===undefined?0:col.width,el:$("<li>").append($("<div>").text(col.heading)).attr({unselectable:"on"}).addClass("wui-gc "+col.cls).click(function(){me.sortList(col)})});if(me.columns.length>1){col.el.resizable({handles:"e",stop:function(){me.sizeCols()},resize:function(e,t){col.width=t.size.width;col.fit=0;Wui.fit(me.cols,"width",me.tbl.find("tr:first").height()*me.total>me.tblContainer.height())}})}me.cols.push(col);me.heading.append(col.el)},setColumns:function(e){var t=this;t.columns=e;t.heading.empty();t.cols=[];t.items=[];t.renderers=[];t.template="<tr class=\"{((wuiIndex % 2 == 0) ? 'even' : 'odd')}\">";$.each(e,function(e,n){var r=n.dataTemplate?n.dataTemplate:n.dataItem?"{"+n.dataItem+"}":"";t.template+="<td><div>"+r+"</div></td>";if(n.vertical){t.el.addClass("has-vert-columns");if(n.cls)n.cls+=" vert-col";else n.cls="vert-col";n.width=50;delete n.fit}t.renderColumn(n,e)});t.template+="</tr>";if(t.autoLoad){if(t.url===null)t.setData(t.data);else t.loadData()}},sizeCols:function(){var e=this;Wui.fit(e.cols,"width",e.tbl.find("tr:first").height()*e.total>e.tblContainer.height());e.tbl.css({width:"1px"});for(var t=0;t<e.cols.length;t++){e.tbl.find("td:eq("+t+")").css({width:e.cols[t].el.outerWidth()-(t===0||t==e.cols.length-1?1:0)})}},sortList:function(e){var t=this;t.mngSorters(e);var n=t.items;n.sort(function(e,n){return t.doSort(0,e,n)});t.tbl.detach();$.each(n,function(e,n){var r=e%2===0;n.el.toggleClass("even",r).toggleClass("odd",!r).appendTo(t.tbl)});t.tbl.appendTo(t.tblContainer);t.sizeCols();t.resetSelect()}})})(jQuery,Wui)